<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AMS：基于类json配置的管理后台前端解决方案</title>
    <url>/2019/08/28/ams/</url>
    <content><![CDATA[<p>今天给大家分享一个开源项目——AMS，一个由唯品会开源的，基于类json配置的管理后台前端解决方案。</p>
<p><img src="https://h5rsc.vipstatic.com/ams/ams-logo.png" alt="logo"></p>
<a id="more"></a>

<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我们先来回顾一下，管理后台的搭建方式。</p>
<ol>
<li>最原始的方式，前后端还未分离，前后端代码融合一起，往往是后端把整个管理后台负责了</li>
<li>发展到前后端分离和JQ兴起，前端可以完全手写实现，也可以使用类似bootstrap这些框架进行快速搭建</li>
<li>在发展到React/Vue这些MVVM框架的兴起，也产生了很多对应的配套，比如Element-ui、Ant Design</li>
</ol>
<p>由于管理后台对UI要求不高以及功能通用，UI框架的使用给前端带来极大的方便，前端可以不需要再关心UI组件的实现，只需要把UI框架提供的组件像搭积木一样搭建，然后再去写数据交互逻辑，就可以比较快的实现一个管理后台。</p>
<p>这样看好像很完美，特别是用着高质量的UI框架，坑少～</p>
<p>但是！积木搭久了，你会发现还是要写不少代码：</p>
<ul>
<li>UI组件代码。比如你写一个列表，拿Element-ui举例，你可能需要用到<code>el-table</code>、<code>el-table-column</code>，然后再来个分页<code>el-pagination</code>。可能90%的场景都是这样的，但是你每次都要写，即使复制，可能也要微调</li>
<li>搭完UI，然后要写数据逻辑交互，比如请求个列表接口，梳理接口字段，把数据塞到表格，然后处理分页时的数据交互逻辑。同理，每个项目每个列表都要这样。</li>
</ul>
<p>上面举例的只是一个列表场景，还有很多比如后台router、表单、图表、搜索、筛选、查增删改等等，这些都是很常见的后台功能吧。</p>
<p>有没有更简单的搭积木呢？最后这个积木能带一些常见的数据交互逻辑！</p>
<p><strong>或者你可以尝试一下AMS！！</strong></p>
<h2 id="AMS"><a href="#AMS" class="headerlink" title="AMS"></a>AMS</h2><p>AMS 是 <code>Admin Materiel System</code> 的首字母缩写，意为管理后台物料系统，是通过JSON配置的形式来快速搭建管理后台的一整套解决方案。</p>
<p>特性：</p>
<ul>
<li>底层基于Vue + Element-UI （AMS并不是想做一套新的UI框架）</li>
<li>通过JSON配置的形式来快速搭建管理后</li>
<li>内置常见的数据交互逻辑，比如查增删改</li>
</ul>
<p>下面来看一个简单Demo：</p>
<iframe width="100%" height="300" src="//jsrun.pro/sehKp/embedded/all/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>


<p>你也可以在 在 Scrimba 上尝试 <a href="https://scrimba.com/c/cmkya6Tp" target="_blank" rel="noopener">AMS入门Demo&gt;&gt;</a></p>
<p><img src="/images/ams.png" alt="ams-about"></p>
<h2 id="项目信息"><a href="#项目信息" class="headerlink" title="项目信息"></a>项目信息</h2><p>开源项目地址：<a href="https://github.com/vipshop/ams" target="_blank" rel="noopener">https://github.com/vipshop/ams</a></p>
<p>开源项目作者：唯品会团队</p>
<p>官方文档地址：<a href="https://vipshop.github.io/ams/" target="_blank" rel="noopener">https://vipshop.github.io/ams/</a></p>]]></content>
      <categories>
        <category>AMS</category>
      </categories>
      <tags>
        <tag>AMS</tag>
        <tag>Vue</tag>
        <tag>Element-UI</tag>
        <tag>前端</tag>
      </tags>
  </entry>
  <entry>
    <title>5G，对前端有什么影响</title>
    <url>/2019/07/19/5G-impact-on-the-front-end/</url>
    <content><![CDATA[<p><img src="/images/5g-01.png" alt="5g-01"></p>
<p>最近在小组做了一次小分享，主题是【5G来袭，我们有何机遇】，有这个想法是源于在社区看到有人面试被问到这个问题。因为2019年5G一直都是热门话题，而小组刚好有次分享机会，所以自己花了点时间做资料收集和整合，看看5G对未来前端的领域有哪些影响。本文主要还是以聊聊看法为主。</p>
<a id="more"></a>

<p>可能有人一看这个标题或者选题，就会冒出想法：一看就是蹭热点的啦，5G真正到民用哪有那么快或者前端只是个写UI的页面仔，能有多大影响…马上关闭页面走人！</p>
<p>且慢！没错，5G到真正普及可能还有到明年甚至后年。但是我想在这里传达的是：<strong>我相信意识会潜移默化的影响你的行动</strong>。有些东西看似遥远，但是你日常有意识的多留意、多思考一下，总会比你真正发生变革时才突然觉悟（原来5G真的已经来来、原来5G真的颠覆大家对前端这个认识，巴拉巴拉…）要更有优势。</p>
<h2 id="移动通信的发展"><a href="#移动通信的发展" class="headerlink" title="移动通信的发展"></a>移动通信的发展</h2><p>先来简单介绍一下基础硬件的移动通信历代发展。</p>
<h3 id="1G"><a href="#1G" class="headerlink" title="1G"></a>1G</h3><p><img src="/images/1g.png" alt="1g"></p>
<p>从上图可以看出，1G时代，移动通信的主要设备就是大哥大，如果看过80、90年代的香港电影，应该会看到过这种大哥大电话。</p>
<h3 id="2G"><a href="#2G" class="headerlink" title="2G"></a>2G</h3><p><img src="/images/2g.png" alt="2g"></p>
<p>到了2G时代，速度到了32Kb/s，除了能打电话，也可以发短信了，还可以利用2G网络来打开非常简单的网页，而且移动手机设备也变小了不少。比较有代表性的比如诺基亚功能机。这时候已经初现移动网页了，但是页面都是最简陋的形式，而且受限于流量资费的影响，普通人基本是很少使用里面的网络功能的。</p>
<h3 id="3G"><a href="#3G" class="headerlink" title="3G"></a>3G</h3><p><img src="/images/3g.png" alt="3g"></p>
<p>3G时代，移动通信的网络速度最高2Mb/s，出现了上网冲浪、手机QQ、3g智能手机等等经典名词。比如下面这张很熟悉的手机QQ网页</p>
<p><img src="/images/5g-04.png" alt="5g-04"></p>
<p>可以看到界面都是比较原始，基本就是文字加链接的形式，偶尔会有一两张图片。3G时代的流量资费对于普通人来说，还是很贵、很少。所以当时基本都是在浏览器设置，把显示图片的功能关闭，这样可以节省很多流量。而且当时的手机QQ很流行，还有飞信（因为发短信不用钱，只要流量就行了）。但是手机qq还是有离线和在线的概念，因为生怕流量被无缘无故流失，基本都是需要网络的时候才打开移动数据功能，然后登录qq上线。</p>
<p><img src="/images/5g-05.jpeg" alt="5g-05"></p>
<p>3G时代还发生了一件很有历史影响性的事件，那就是乔布斯带来了<strong>3G触屏智能手机</strong>。原来手机可以长这样，不需要键盘！可以触屏！也正是苹果，带来了移动应用APP这个概念。那种惊艳真的无法用言语表达。</p>
<h3 id="4G"><a href="#4G" class="headerlink" title="4G"></a>4G</h3><p><img src="/images/4g.png" alt="4g"></p>
<p>到了4G，网络速度最高达到100Mb/s，是上一代的50倍。因为有了苹果的3G智能手机，后面陆续的智能手机也出现了，而小米，把国产的智能手机开启了在当时看来非常便宜的价格普及。有了4G和智能手机，人们能用手机的事情就多啰：以前只要电脑看的网页开始为移动端适配了，网页也多了图片、视频和音频等更丰富的形式，各种语音聊天、视频社交、视频直播接踵而至，在线社交也没有了上线和离线的概念，因为大家<code>always online</code>。硬件的发展也带动了移动互联网的技术发展——H5技术到来，也带来了火爆的移动互联网时代。</p>
<p><img src="/images/5g-16.jpg" alt="5g-15"></p>
<h3 id="5G"><a href="#5G" class="headerlink" title="5G"></a>5G</h3><p><img src="/images/5g.png" alt="5g"></p>
<p>2019年，5G的商用牌照已经下发，意味着5G时代将要来临了。是第五代移动通信技术，包含毫米波、波束赋形、Massive MIMO 等众多关键技术。这么多的技术，好像也看不懂，那么5G有什么牛的地方呢？有三大普通人也能明显感知的特性：</p>
<ul>
<li><p>高速率：未来理论上10Gbps 的通讯速率，相比4G提升了约100倍</p>
</li>
<li><p>低延时：1ms的超低延时，相比于4G网络小于50ms的延时，再次降低了一个数量级</p>
</li>
<li><p>广连接：每平方公里100万个设备接入，这也让每个物联网设备单独接入网络成为可能</p>
</li>
</ul>
<p>我们在看5G介绍时，经常看到的就是下载电影只要多少多少秒～看来速度，一直都是人们最能直接感受的变化了。而这些特性，又将会给对前端带来什么影响呢？下面本文从三方面分析（终于入正题了）。</p>
<h2 id="对前端有什么影响"><a href="#对前端有什么影响" class="headerlink" title="对前端有什么影响"></a>对前端有什么影响</h2><h3 id="XR（VR-AR）技术"><a href="#XR（VR-AR）技术" class="headerlink" title="XR（VR/AR）技术"></a>XR（VR/AR）技术</h3><p><img src="/images/5g-03.jpg" alt="5g-03"></p>
<p>其实，在2015年~2016年XR技术就已经火了一把，和前端关系比较大的有比如：腾讯游戏在ChinaJoy首曝的《龙之谷》webvr小游戏（<code>Three.js</code>）、支付宝AR红包、全景视频和各种XR活动推广专题等等。</p>
<p>下图是腾讯游戏在ChinaJoy给游戏爱好者现场玩的webvr小游戏场景：<br><img src="/images/5g-11.png" alt="5g-11"></p>
<p>下图是支付宝AR红包：<br><img src="/images/5g-10.jpg" alt="5g-10"></p>
<p>下图是一个妹子在玩AR活动：<br><img src="/images/5g-09.jpg" alt="5g-09"></p>
<h4 id="5G如何影响XR技术？"><a href="#5G如何影响XR技术？" class="headerlink" title="5G如何影响XR技术？"></a>5G如何影响XR技术？</h4><ul>
<li><p>消除时延所致的眩晕感</p>
</li>
<li><p>全新的XR解决方案，即将VR运行能力由终端向云端进行转移的“云计算”</p>
</li>
<li><p>设备无线化。5G云，将大大降低VR/AR体验对“用户终端硬件性能”的要求</p>
</li>
<li><p>VR直播/VR流媒体，5G将带来体育赛事和演唱会等大型场景的现场VR直播</p>
</li>
<li><p>更多场景：VR/AR模拟训练、AR车载导航等应用领域</p>
</li>
</ul>
<p>可以看出，5G解决了很多痛点，比如因为时延的眩晕，比如因为有线的缠绕和设备笨重等等。</p>
<h4 id="XR与前端"><a href="#XR与前端" class="headerlink" title="XR与前端"></a>XR与前端</h4><p>我坚信的一点是有交互的地方就有前端的需求，所以不管是平面的交互，还是未来的立体交互。</p>
<p>即使回到上面的传统的Web XR层面，5G的出现在加载速度、云计算等方面将会给用户带来更好的体验，从而推动Web XR技术的发展；</p>
<p>而放眼未来，当这些XR设备越来越普及时，酷炫的交互会不会对前端发起新的挑战呢？会不会带来更广义的“前端”技术发展呢？</p>
<p>回到本质：XR技术也无一例外不与图形技术相关联。</p>
<p>引用一句在社区看到的：</p>
<blockquote>
<p>图形技术可能是仅有的与前端有密切联系的计算机底层技术了，因为所谓的UI就是靠图形接口调用GPU绘制而成的，这样就意味着掌握图形技术就能更深度地定制UI。</p>
</blockquote>
<p>所以图形技术很有可能在未来前端大放异彩。未来的前端UI可能不再是简单常规的流体布局，不再是简单粗糙的元素组件，甚至不再是基于平面设计的UI，而是更加多元化、更加细粒度、更加酷炫和立体的UI。<br><img src="/images/5g-13.jpg" alt="5g-13"></p>
<p>而且我们目前的UI门槛比较低，未来可能会被AI代替（下面说AI的时候会说到）。而图形技术就不一样，首先被AI替代的可能性或者说实现性还是比普通UI要低很多。其次现在这方面的前端还是比较少，一方面是门槛比较高（数学计算、美术、空间思维等等），另一方面市场需求相对较小，可能在一些游戏公司会相对多点（游戏公司在做游戏推广的页面对酷炫UI要求比较多，甚至把游戏里面的某些场景通过web小游戏来呈现给玩家，让玩家在没有下载游戏之前就能进行体验），还有一方面，就是图形开发成本相对比较大，而给企业带来收入不成正比（没钱的企业养个普通开发都嫌成本高了）。</p>
<h3 id="人工智能——AI-IN-FE"><a href="#人工智能——AI-IN-FE" class="headerlink" title="人工智能——AI IN FE"></a>人工智能——AI IN FE</h3><p>如果你是前端，一看到这个领域，会觉得有点遥远。前端能做AI？在浏览器上做机器学习？不能吧？</p>
<p>的确，看起来是比较遥远，但是我们换一种思维，如果从工具层面呢？</p>
<p>不过，目前的确有支持在浏览器上跑的机器学习开源项目。先来介绍两个开源项目：</p>
<p><a href="https://github.com/tensorflow/tensorflow" target="_blank" rel="noopener">TensorFlow</a>，一个基于数据流编程（<code>dataflow programming</code>）的符号数学系统，被广泛应用于各类机器学习（<code>machine learning</code>）算法的编程实现，其前身是谷歌的神经网络算法库<code>DistBelief</code>。</p>
<p><a href="https://github.com/tensorflow/tfjs" target="_blank" rel="noopener">TensorFlow.js</a>，<code>TensorFlow</code> 出了 JS 版本。一个利用 WebGL 来进行加速的机器学习类库，它基于浏览器，提供了高层次的 <code>JavaScript API</code> 接口。</p>
<p>目前算是比较靠谱的前端+AI的场景就是自动化UI，将设计师的设计稿自动生成UI组件，闲鱼的大前端团队在2019.06的GIAC（全球互联网架构大会）分享了【<a href="https://www.infoq.cn/article/6xDM_B49TzVatcFd8m3z" target="_blank" rel="noopener">UI2CODE图片识别自动生成代码</a>】的项目。</p>
<p><img src="/images/5g-14.png" alt="5g-14"></p>
<p>上面的文章有视频介绍，看效果，还原度还是比较高的。UI2CODE的视频截图：</p>
<p><img src="/images/5g-17.png" alt="5g-17"></p>
<p>如果这个未来真的能满足业务，有多少前端目前的工作是可以被替代的！细思极恐啊！所以对这方面有兴趣的，可以研究下，多从日常的痛点思考，即使是做工具，像上面的UI2CODE工具，对行业也是影响深远的。</p>
<h3 id="物联网（Internet-of-Things-IoT）"><a href="#物联网（Internet-of-Things-IoT）" class="headerlink" title="物联网（Internet of Things, IoT）"></a>物联网（Internet of Things, IoT）</h3><p><img src="/images/5g-06.png" alt="5g-06"></p>
<p>前端在想IoT上大展身手？这不是扯淡么？</p>
<p>没错，从目前来看，的确有点扯。因为两个原因：</p>
<ul>
<li><p>IoT是低性能低功耗低内存的设备，适合运行时高性能偏底层的编程语言，比如C语言</p>
</li>
<li><p>JavaScript功耗是个大问题（充电五分钟，待机5秒钟）</p>
</li>
</ul>
<p>下面看一张目前主流IoT设备的内存情况：</p>
<p><img src="/images/5g-07.png" alt="5g-07"></p>
<p>但是，我们不是在聊未来吗？回头看看，JavaScript最初的出现是为了解决浏览器端用户交互的问题，到后来Node.js的出现，把它带到了服务端，很不可思议吧？后来因为Node.js，把前端带到了PC桌面应用开发，再到现在移动端app的开发。看来，前端是要一统江湖啊。不过，这里“前端”的定义当然也发生了变化，不再是我们传统的web前端那么简单了。</p>
<p>那么怎么把JavaScript运行到IoT设备呢？</p>
<p><a href="https://github.com/jerryscript-project/jerryscript" target="_blank" rel="noopener">JerryScript</a> 虚拟机来了！三星还为IoT设备定制了JavaScript虚拟机（JerryScript ），它能够运行在小于 64KB 内存上，且全部代码能够存储在不足 200KB 的只读存储（ROM）上。</p>
<p>来个<code>Hollo World</code>：<br><img src="/images/5g-08.png" alt="5g-08"></p>
<p>而和虚拟机配套使用，三星还推出了 <a href="https://github.com/jerryscript-project/iotjs" target="_blank" rel="noopener">IoT.js</a>，基于 <code>JerryScript</code> 的“物联网”JavaScript框架。 <code>IoT.js</code> 使用 <a href="https://github.com/libuv/libuv" target="_blank" rel="noopener">libuv</a> 库实现类似于<code>Node.js</code>的事件驱动（非阻塞I / O模型）。向下兼容 <code>Node.js</code>， 遵守 <code>CommonJS</code> 规范中的模块化编程，并且支持 <code>Node.js</code> API 中核心功能的子集。目标是在资源受限的设备中运行，例如只有几千字节的RAM可用设备。</p>
<p><img src="/images/5g-02.png" alt="5g-02"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="/images/5g-15.png" alt="5g-15"></p>
<p>前端在不断发展，而其代表的含义和领域也在发生变化。</p>
<p>每次网络、终端设备的发展必然会推动web技术的更新，而“前端”这个领域也会有新的诠释，也许这也是我们新的机遇！</p>
<p><img src="/images/5g-12.png" alt="5g-12"></p>]]></content>
      <categories>
        <category>其它</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>5G</tag>
      </tags>
  </entry>
  <entry>
    <title>Webpack项目使用alias报错export &#39;default&#39; (imported as &#39;xxx&#39;) was not found in &#39;xxxx&#39;</title>
    <url>/2019/09/08/export-default-imported-as-xxx-was-not-found/</url>
    <content><![CDATA[<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>最近遇到一个Webpack项目报错很头疼：通常我们开发npm包的时候，都会需要经过本地项目测试的，为了调试方便，会通过<code>npm link</code>或者<code>alias</code>来引入本地开发好的包。</p>
<p>比如vue-cli 3.0项目，在<code>vue.config.js</code>配置alias引入<code>@ams-team/ams</code>这个包：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        config.resolve = &#123;</span><br><span class="line">            extensions: [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">            alias: &#123;</span><br><span class="line">                <span class="string">'@ams-team/ams'</span>: resolve(<span class="string">'../../packages/ams'</span>) <span class="comment">// 一般包的package.json会通过 main: "lib/ams.js"来知道引入文件的</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>这时候你在项目引入 <code>import ams from &#39;@ams-team/ams&#39;</code> 会得到下面报错：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export &apos;default&apos; (imported as &apos;ams&apos;) was not found in &apos;@ams-team/ams&apos;</span><br></pre></td></tr></table></figure>

<p>但是如果我从 npm 上下载自己的包是不报错的。</p>
<a id="more"></a>

<h2 id="报错的根本原因"><a href="#报错的根本原因" class="headerlink" title="报错的根本原因"></a>报错的根本原因</h2><p>通过谷歌了一番，发现报错的根本原因是：<code>import</code> 和 <code>module.exports</code> 语法混用。</p>
<p>项目引入肯定是使用 <code>import</code> 语法的，如果出现混用，那就是打包的文件是使用 <code>module.exports</code> ？然后赶紧搜索了一下 <code>@ams-team/ams</code> 下的 <code>lib</code> 文件，发现果然有<code>module.exports</code>。。。<br>难道是 Webpack 没有转成 ES6 的问题？</p>
<p>经过查阅Webpack官方文档，发现Webpack会将项目打包成 <code>ES5</code> 的版本，而在新项目里用 <code>import</code> 里引入了带有 <code>module.exports</code> 语句的文件时就会导致上面的报错。</p>
<p>那如何解析 <code>npm</code> 下载后可以正常使用呢？</p>
<p><strong>猜测：</strong></p>
<p>我们在写 <code>webpack.config.js</code> 会发现有一项 <code>Exclude</code>，说是可以不对某些文件进行编译从而提高编译性能。难道Webpack对从 <code>npm</code> 下载下来的文件进行预先编译，将其转成 ES6，而本地引入的话没有预先编译。</p>
<p>为了验证我的猜测，做了以下测试：</p>
<ol>
<li>将 <code>ams/lib</code> 下所有文件拷到新项目的 <code>/src</code> 里，直接本地引入，同样报错。</li>
<li>将 <code>ams/lib</code> 下所有文件拷贝到新项目的 <code>/node_modules/ams</code> 里，直接本地使用 <code>import &#39;/node_modules/ams/ams.js&#39;</code> 引入，成功！</li>
</ol>
<p>通过测试，验证了 <strong>Webpack 会对 <code>/node_modules</code> 下的文件进行预先编译，再引入到真实项目中，这样就没有 <code>module.exports</code> 的语句了</strong> 这个猜测是对的</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>我真的需要做本地调试，那怎么办呢？我总不能每次都拷贝进引入项目的<code>/node_modules/</code>吧？</p>
<p>其实不用，我们还是可以配置alias来实现引入包的源码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        config.resolve = &#123;</span><br><span class="line">            extensions: [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">            alias: &#123;</span><br><span class="line">                <span class="string">'@ams-team/ams'</span>: resolve(<span class="string">'../../packages/ams/src'</span>) <span class="comment">// 直接引用src源码</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>但是这样可能会带来另外一个问题：因为引入源码，那就是每次都要把这个包进行编译，所以可能会涉及到编译速度和编译依赖问题，那就另外讨论了。</p>]]></content>
      <categories>
        <category>Webpack</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>Webpack</tag>
        <tag>alias</tag>
        <tag>export</tag>
        <tag>import</tag>
      </tags>
  </entry>
  <entry>
    <title>使用chrome extension解决gitlab在线编辑时输入中文出现错乱的问题</title>
    <url>/2017/11/12/chrome-extension-solves-gitlab-online-edit-bug/</url>
    <content><![CDATA[<p>先上一张gif效果图：</p>
<p><img src="https://github.com/w3cmark/blog/blob/master/assets/gitlab-chrome-input-bug.gif?raw=true" alt="gitlab-chrome-input-bug"></p>
<p>我们团队内部搭建了gitlab作为代码托管，目前的版本是<code>GitLab Community Edition 8.17.5 9a564a8</code>，在升级到这个版本时，发现在chrome下，在线编辑无法正常输入中文了，出现如上动图的错乱效果，而在firefox是正常的。</p>
<a id="more"></a>

<p>一开始怀疑是chrome更新版本后的问题，但是github的在线编辑是正常的，后来通过chrome开发者工具debug，发现是gitlab使用的在线编辑器有问题。无论gitlab还是github，这种在线编辑代码都是借助于一些web编辑器实现的，比如<a href="https://ace.c9.io/" target="_blank" rel="noopener">aceeditor</a>，而这里gitlab用的正是<code>aceeditor</code>，因此第一时间跑去aceeditor官网，嗯，人家的是正常的。所以gitlab出现这种问题的原因就是aceeditor编辑器的版本在新版chrome下的bug。</p>
<p>找到问题源头，解决办法也就有眉目了：</p>
<ul>
<li><p>直接更新<code>GitLab Community Edition</code>版本到最新版，看看官方是否更换了aceeditor编辑器的版本解决了这个问题。</p>
</li>
<li><p>升级gitlab，可能会担心升级过程会不会有什么新问题，特别是大版本更新就更要慎重。既然这样，那就直接自己在现版本手动去更新aceeditor编辑器，理论上找到gitlab的安装，找到编辑器的相关文件，替换成新的版本。前提是你要摸索清gitlab的目录结构，完整替换编辑器版本。听起来有点麻烦，而且也有一定风险~</p>
</li>
<li><p>这里介绍另一种思路，通过<code>chrome extension</code>在打开编辑页时替换编辑器。这种不是治本的方案，但感觉也是一种思路，刚好团队本身有一个在用从chrome插件，所以把解决方案放进现有的插件即可。这个方案可能适用性和参考意义不大，但这种思路说不定能给到你一些新的想法呢</p>
</li>
</ul>
<p>下面详细说下第三种方案的操作细节：<br>（涉及到chrome extension的相关细节，这里就不详细描述，默认你拥有chrome extension的开发能力）</p>
<h4 id="下载最新版的aceeditor编辑器"><a href="#下载最新版的aceeditor编辑器" class="headerlink" title="下载最新版的aceeditor编辑器"></a>下载最新版的aceeditor编辑器</h4><p>这一步很简单，直接去官网下载即可<a href="https://ace.c9.io/" target="_blank" rel="noopener">aceeditor</a>，然后把编辑器的相关文件放到chrome插件下，比如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|--src  //插件源码</span><br><span class="line">|    |--js</span><br><span class="line">|    |    |--lib</span><br><span class="line">|    |    |    |--src-min-noconflict  //aceeditor</span><br></pre></td></tr></table></figure>

<p>到时候打包插件时会一起打包的。</p>
<h4 id="加载编辑器文件"><a href="#加载编辑器文件" class="headerlink" title="加载编辑器文件"></a>加载编辑器文件</h4><p>什么时候去加载新版的编辑器文件呢？因为我们只需要在gitlab编辑界面才用到，所以通过URL匹配来识别当前是编辑界面，然后再去加载aceeditor相关文件。另外还可以根据当前的编辑文件类型，来加载对应的编辑器文件，然后再通过<code>chrome.tabs.executeScript</code>来实现。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">chrome.tabs.onUpdated.addListener(<span class="function"><span class="keyword">function</span> (<span class="params">tabId, changeInfo, tab</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// when complete</span></span><br><span class="line">    <span class="keyword">if</span> (changeInfo.status === <span class="string">'complete'</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="regexp">/https:\/\/(你的系统域名)\/.+\/(edit|blob)\/.+/ig</span>.test(tab.url))&#123;</span><br><span class="line">            <span class="keyword">var</span> newurl = tab.url.replace(<span class="string">'(你的系统域名)'</span>,<span class="string">''</span>),</span><br><span class="line">                r_file_suffix = <span class="regexp">/((?!(\.|\/))[\s\S])+\.([a-z]+)/ig</span>;</span><br><span class="line">            newurl.match(r_file_suffix);</span><br><span class="line">            <span class="keyword">var</span> file_suffix = <span class="built_in">RegExp</span>.$<span class="number">3</span>,</span><br><span class="line">                jsFiles = [</span><br><span class="line">                <span class="string">'/js/lib/jquery-2.1.3.min.js'</span>,</span><br><span class="line">                <span class="string">'/js/lib/src-min-noconflict/ace.js'</span></span><br><span class="line">                ];</span><br><span class="line">            <span class="comment">//根据文件类型</span></span><br><span class="line">            <span class="keyword">switch</span>(file_suffix)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'js'</span>:</span><br><span class="line">                jsFiles.push(<span class="string">'/js/lib/src-min-noconflict/mode-javascript.js'</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'tmpl'</span>:</span><br><span class="line">                jsFiles.push(<span class="string">'/js/lib/src-min-noconflict/mode-html.js'</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'md'</span>:</span><br><span class="line">                jsFiles.push(<span class="string">'/js/lib/src-min-noconflict/mode-markdown.js'</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span> :</span><br><span class="line">                jsFiles.push(<span class="string">'/js/lib/src-min-noconflict/mode-'</span>+ file_suffix +<span class="string">'.js'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//替换编辑器以及保存等逻辑</span></span><br><span class="line">            jsFiles.push(<span class="string">'/js/fixgitlabinput.js'</span>);</span><br><span class="line"></span><br><span class="line">            chrome.tabs.executeScript(tabId, &#123;</span><br><span class="line">                code: <span class="string">'var injected = window.octotreeInjected; window.octotreeInjected = true; injected;'</span>,</span><br><span class="line">                runAt: <span class="string">'document_start'</span></span><br><span class="line">            &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> cssFiles = [<span class="string">'/css/fixgitlabedit.css'</span>];</span><br><span class="line"></span><br><span class="line">                eachTask([<span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">                  <span class="keyword">return</span> eachItem(cssFiles, inject(<span class="string">'insertCSS'</span>), cb);</span><br><span class="line">                &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">                  <span class="keyword">return</span> eachItem(jsFiles, inject(<span class="string">'executeScript'</span>), cb);</span><br><span class="line">                &#125;]);</span><br><span class="line"></span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">inject</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">                  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">file, cb</span>) </span>&#123;</span><br><span class="line">                    chrome.tabs[fn](tabId, &#123; <span class="attr">file</span>: file, <span class="attr">runAt</span>: <span class="string">'document_start'</span> &#125;, cb);</span><br><span class="line">                  &#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="替换操作"><a href="#替换操作" class="headerlink" title="替换操作"></a>替换操作</h4><p>加载到编辑器文件，那最后一步就是进行编辑器替换，以及新编辑器的初始化，最后还要在保存时把新编辑器的内容提交。<br>这些逻辑放进了单独js文件<code>fixgitlabinput.js</code>处理。<br>这里我选择通过插入一个新的按钮来进行新编辑器的切换：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fix_btn = <span class="string">'&lt;span class="fix-btn" id="js-fix-btn"&gt;中文编辑&lt;/span&gt;'</span>;</span><br><span class="line">$(<span class="string">'body'</span>).append(fix_btn);</span><br></pre></td></tr></table></figure>

<p>当点击这个按钮时，会做两件事：<br>（1）根据当前地址，获取目前编辑文件的内容<br>（2）把获取到的文件内容用新的编辑器初始化，并隐藏旧版的编辑器，显示新版的编辑器</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fix_btn = <span class="string">'&lt;a href="#fixgitlabedit" class="fix-btn" id="js-fix-btn"&gt;中文编辑&lt;/a&gt;'</span>;</span><br><span class="line">$(<span class="string">'body'</span>).append(fix_btn);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(location.hash == <span class="string">'#fixgitlabedit'</span>)&#123;</span><br><span class="line">     <span class="comment">//传入当前地址和文件类型</span></span><br><span class="line">    fixeditor(curhref, file_mode);</span><br><span class="line">    $(<span class="string">'#js-fix-btn'</span>).hide();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fixeditor</span>(<span class="params">curhref, file_mode</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//隐藏旧的编辑器</span></span><br><span class="line">    $(<span class="string">'#editor'</span>).hide();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> fix_div = <span class="string">'&lt;pre id="js-fix-editor" class="fix-editor"&gt;&lt;pre&gt;'</span>,</span><br><span class="line">        new_editor,</span><br><span class="line">        $old_editor_par = $(<span class="string">'#editor'</span>).parent();</span><br><span class="line">    <span class="comment">// 插入新的编辑器</span></span><br><span class="line">    $old_editor_par.append(fix_div);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> $form_actions = $(<span class="string">'form .form-actions'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//隐藏旧的保存按钮</span></span><br><span class="line">    $form_actions.find(<span class="string">'.btn.commit-btn.js-commit-button.btn-create'</span>).hide();</span><br><span class="line">    <span class="keyword">var</span> new_submit_btn = <span class="string">'&lt;button name="button" class="btn btn-create new-submit-btn"&gt;Commit Changes&lt;/button&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//插入新的保存按钮</span></span><br><span class="line">    $form_actions.prepend(new_submit_btn);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存操作</span></span><br><span class="line">    $form_actions.on(<span class="string">'click'</span>, <span class="string">'.new-submit-btn'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($(<span class="keyword">this</span>).hasClass(<span class="string">'disabled'</span>))&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">        e.preventDefault();</span><br><span class="line">        $(<span class="keyword">this</span>).addClass(<span class="string">'disabled'</span>);</span><br><span class="line">        <span class="comment">//获取编辑器的内容，aceeditor提供的方法</span></span><br><span class="line">        <span class="keyword">var</span> new_val = new_editor.getValue();</span><br><span class="line">        $(<span class="string">'#file-content'</span>).val(new_val);</span><br><span class="line">        $(<span class="string">"form.form-horizontal.js-quick-submit.js-requires-input.js-edit-blob-form"</span>)[<span class="number">0</span>].submit();</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据当前地址获取文件内容</span></span><br><span class="line">    getHttpRequest(curhref, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> r_editor_text = <span class="regexp">/\&lt;pre class="js-edit-mode-pane" id="editor"\&gt;([\s\S]*)\&lt;\/pre\&gt;/igm</span>;</span><br><span class="line">        data.match(r_editor_text);</span><br><span class="line">        <span class="keyword">var</span> editor_text = <span class="built_in">RegExp</span>.$<span class="number">1</span>;</span><br><span class="line">        $old_editor_par.find(<span class="string">'#js-fix-editor'</span>).html(editor_text);</span><br><span class="line">        <span class="comment">//获取编辑器的内容，aceeditor提供的方法</span></span><br><span class="line">        new_editor = ace.edit(<span class="string">"js-fix-editor"</span>);</span><br><span class="line">        new_editor.session.setMode(<span class="string">"ace/mode/"</span>+file_mode);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHttpRequest</span>(<span class="params">href, callback</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.open(<span class="string">"GET"</span>, href, <span class="literal">true</span>);</span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> data = xhr.responseText;</span><br><span class="line">        <span class="keyword">typeof</span> callback == <span class="string">'function'</span> &amp;&amp; callback(data);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>到这里，就可以正常输入中文并保存了，对于没有接触chrome插件开发的人来说可能比较麻烦，so，就当新想法的折腾呗~</p>]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>gitlab</tag>
        <tag>chrome extension</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutter 入门问题</title>
    <url>/2019/12/01/flutter/</url>
    <content><![CDATA[<p>本文收集了在入门flutter时，被哪些问题卡住了。</p>
<a id="more"></a>

<h2 id="在执行flutter-run时，卡在了Resolving-dependencies…"><a href="#在执行flutter-run时，卡在了Resolving-dependencies…" class="headerlink" title="在执行flutter run时，卡在了Resolving dependencies…"></a>在执行flutter run时，卡在了Resolving dependencies…</h2><p>出现这种问题查到到原因是网络问题（但是我尝试设全局代理也没成功），官方到<a href="https://github.com/flutter/flutter/issues/11856" target="_blank" rel="noopener">issues</a>也提到这个问题。</p>
<blockquote>
<p>我的电脑系统是mac OS 10.14.6</p>
</blockquote>
<ul>
<li>解决方法一：</li>
</ul>
<p>手动去构建android的gradlew（尝试过，对我没效）</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">./flutter_project_name/android/gradlew</span><br><span class="line"></span><br><span class="line"><span class="comment"># After successful build.</span></span><br><span class="line"><span class="comment"># Try run the project again.</span></span><br><span class="line">flutter run</span><br></pre></td></tr></table></figure>

<ul>
<li>解决方法二：</li>
</ul>
<p>修改 <code>./flutter_project_name/android/build.gradle</code>里的<code>repositories</code>（有两处），使用国内代理（对我有效）。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    // google()</span><br><span class="line">    // jcenter()</span><br><span class="line">    maven &#123; url &apos;https://maven.aliyun.com/repository/google&apos; &#125;</span><br><span class="line">    maven &#123; url &apos;https://maven.aliyun.com/repository/jcenter&apos; &#125;</span><br><span class="line">    maven &#123; url &apos;http://maven.aliyun.com/nexus/content/groups/public&apos; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="VScode-在dart后缀文件里，没有自动补全提示"><a href="#VScode-在dart后缀文件里，没有自动补全提示" class="headerlink" title="VScode 在dart后缀文件里，没有自动补全提示"></a>VScode 在dart后缀文件里，没有自动补全提示</h2><h2 id="VScode-安装flutter环境后，dart-在活动进程里-CPU-90-100"><a href="#VScode-安装flutter环境后，dart-在活动进程里-CPU-90-100" class="headerlink" title="VScode 安装flutter环境后，dart 在活动进程里 CPU 90 ~ 100"></a>VScode 安装flutter环境后，dart 在活动进程里 CPU 90 ~ 100</h2>]]></content>
      <categories>
        <category>flutter</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>flutter</tag>
      </tags>
  </entry>
  <entry>
    <title>常用工具集备忘</title>
    <url>/2018/01/15/common-toolset-memo/</url>
    <content><![CDATA[<p>前端开发过程中用到的各种各样的工具，经常会出现千奇百怪的问题，记录下来，下次再出现时可以快速定位解决。</p>
<a id="more"></a>

<h3 id="nrm——NPM源管理"><a href="#nrm——NPM源管理" class="headerlink" title="nrm——NPM源管理"></a>nrm——NPM源管理</h3><p><a href="https://github.com/Pana/nrm" target="_blank" rel="noopener">nrm官方&gt;&gt;</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 安装</span><br><span class="line">npm install -g nrm</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Usage: nrm [options] [command]</span><br><span class="line"></span><br><span class="line">  Commands:</span><br><span class="line"></span><br><span class="line">    ls                           List all the registries</span><br><span class="line">    use &lt;registry&gt;               Change registry to registry</span><br><span class="line">    add &lt;registry&gt; &lt;url&gt; [home]  Add one custom registry</span><br><span class="line">    del &lt;registry&gt;               Delete one custom registry</span><br><span class="line">    home &lt;registry&gt; [browser]    Open the homepage of registry with optional browser</span><br><span class="line">    test [registry]              Show the response time for one or all registries</span><br><span class="line">    help                         Print this help</span><br><span class="line"></span><br><span class="line">  Options:</span><br><span class="line"></span><br><span class="line">    -h, --help     output usage information</span><br><span class="line">    -V, --version  output the version number</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="npm-报错（npm-ERR-cb-never-called-）"><a href="#npm-报错（npm-ERR-cb-never-called-）" class="headerlink" title="npm 报错（npm ERR! cb() never called!）"></a>npm 报错（<code>npm ERR! cb() never called!</code>）</h3><p>出现环境：OS X/macOS<br>官方issue：<a href="https://github.com/npm/npm/issues/17839" target="_blank" rel="noopener">https://github.com/npm/npm/issues/17839</a></p>
<p>这个报错无论是在官方的issue还是Stack Overflow，都有人反馈，解决思路主要有两种：<br>（1）来自Stack Overflow的解决方案：<code>npm cache verify</code> 和 <code>npm cache clean</code>（网上搜索还有就是安装node的助手，但是我实践是不行的，因为在安装 <code>npm install -g n</code> 本身也会报这个错）<br>（2）来自官方的issue评论的解决方案：删除node相关的安装，然后重装node（但看起来操作比较复杂，又要删这，又要删哪的）</p>
<p><strong>我的最终解决方案：</strong><br>去<a href="https://nodejs.org/zh-cn/download/" target="_blank" rel="noopener">官方下载</a>对应的安装包（尝试过<code>brew install node</code>安装，但是报错：<code>Error: Checksum mismatch</code>，而且我一开始不是通过brew安装的，所以放弃折腾了），我直接选的是当前长期支持版的最新版，直接安装覆盖即可。<br><img src="https://user-images.githubusercontent.com/7434649/52831068-23b6da80-310e-11e9-9f69-b9bb1b55b9b5.png" alt="image"></p>
<hr>
<h3 id="GitHub-Pages怎么绑定自己的域名"><a href="#GitHub-Pages怎么绑定自己的域名" class="headerlink" title="GitHub Pages怎么绑定自己的域名"></a>GitHub Pages怎么绑定自己的域名</h3><p>第一步：申请一个属于自己的域名</p>
<p>第二步：在域名提供商，进入域名解析设置，以我的<a href="http://w3cmark.github.io" target="_blank" rel="noopener">http://w3cmark.github.io</a>为例<br>（1）先添加一个CNAME，主机记录写<code>@</code>，后面记录值写上你的<code>w3cmark.github.io</code><br>（2）再添加一个CNAME，主机记录写<code>www</code>，后面记录值也是<code>w3cmark.github.io</code><br>这样别人用<code>www</code>和不用<code>www</code>都能访问你的网站（其实<code>www</code>的方式，会先解析成<code>http://w3cmark.github.io</code>，然后根据CNAME再变成<code>http://wwww.3cmark.com</code>，即中间是经过一次转换的）。<br><img src="https://user-images.githubusercontent.com/7434649/48395361-04e12a80-e752-11e8-9047-13d3dbebd6ca.png" alt="image"></p>
<p>第三步：在GitHub Pages项目的Setting–&gt;GitHub Pages–&gt;Custom domain（自定义域名）去直接填写<br>你自己的域名，如<code>www.w3cmark.com</code>，前面不需要<code>http://</code>，然后点击旁边的save按钮保存即可。（也可以不需要带<code>www</code>，如<code>w3cmark.com</code>。两者的区别是，如果带<code>www</code>，访问时不管是否带有www，浏览器地址栏访问的都是<code>www.w3cmark.com</code>，反之亦然。）<br><img src="https://user-images.githubusercontent.com/7434649/48397959-660cfc00-e75a-11e8-8b3b-3912d13c0f4b.png" alt="image"><br><img src="https://user-images.githubusercontent.com/7434649/48398366-85585900-e75b-11e8-851f-d47577aa1078.png" alt="image"></p>
<blockquote>
<p>上面介绍的是CNAME别名记录，也可以使用A记录，后面的记录值是写GitHub Pages里面的ip地址，但有时候IP地址会更改，导致最后解析不正确，所以还是推荐用CNAME别名记录要好些，不建议用IP。</p>
</blockquote>
<p>上面三步做完，一般等几分钟，解析生效，就可以用你自己域名访问下试试啦～</p>
<hr>
<h3 id="GitHub-Pages绑定自己的域名后，怎么支持https"><a href="#GitHub-Pages绑定自己的域名后，怎么支持https" class="headerlink" title="GitHub Pages绑定自己的域名后，怎么支持https"></a>GitHub Pages绑定自己的域名后，怎么支持https</h3><blockquote>
<p>2018.05.01官方支持https <a href="https://blog.github.com/2018-05-01-github-pages-custom-domains-https/" target="_blank" rel="noopener">Custom domains on GitHub Pages gain support for HTTPS</a></p>
</blockquote>
<p>如果你是采用CNAME别名记录的方式，开启https很简单，只需要在在GitHub Pages项目的Setting去勾选即可（如果你是用ip做解析的，需要更新一下ip，具体可以看GitHub官方博客）<br><img src="https://user-images.githubusercontent.com/7434649/48398048-aa000100-e75a-11e8-83e2-134af48fc028.png" alt="image"></p>
<hr>
<h3 id="Whistle使用"><a href="#Whistle使用" class="headerlink" title="Whistle使用"></a>Whistle使用</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 同一个域名根据不同的path指向不同的ip </span><br><span class="line">/api.w3cmark.com\/(?!column)(.*)/  http://127.0.0.1:9529/$1</span><br><span class="line">^api.w3cmark.com/column/*** host://10.199.133.253/column/$1</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="MAC-命令相关"><a href="#MAC-命令相关" class="headerlink" title="MAC 命令相关"></a>MAC 命令相关</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 修改hosts</span><br><span class="line">sudo vi /etc/hosts</span><br><span class="line"></span><br><span class="line"># 打开当前路径的finder</span><br><span class="line">open .</span><br><span class="line"></span><br><span class="line"># 全局命令存放路径</span><br><span class="line">/usr/local/bin</span><br><span class="line"></span><br><span class="line"># 全局命令代码存放路径</span><br><span class="line">/usr/local/lib</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title>前端开源项目目录结构</title>
    <url>/2017/12/29/front-end-open-source-project-directory-structure/</url>
    <content><![CDATA[<p>得益于各种自动化工具，如今前端开源项目的目录结构越来越复杂了，在看别人代码时可能一脸懵逼，在这里整理了常见的目录结构。</p>
<a id="more"></a>

<h2 id="文字版如下："><a href="#文字版如下：" class="headerlink" title="文字版如下："></a>文字版如下：</h2><h3 id="circleci"><a href="#circleci" class="headerlink" title=".circleci"></a>.circleci</h3><blockquote>
<p>存放CircleCI持续集成相关，目前只支持github和Bitbucket代码管理工具</p>
</blockquote>
<h3 id="build"><a href="#build" class="headerlink" title="build"></a>build</h3><blockquote>
<p>webpack的相关配置，包括基本配置、开发环境配置、生产环境配置等</p>
</blockquote>
<h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><blockquote>
<p>针对开发环境，生产环境，测试环境的配置信息</p>
</blockquote>
<h3 id="dist"><a href="#dist" class="headerlink" title="dist"></a>dist</h3><blockquote>
<p>存放编译打包后的文件</p>
</blockquote>
<h3 id="examples"><a href="#examples" class="headerlink" title="examples"></a>examples</h3><blockquote>
<p>存放例子</p>
</blockquote>
<h3 id="flow"><a href="#flow" class="headerlink" title="flow"></a>flow</h3><blockquote>
<p>flow（JavaScript静态类型检查器，貌似Eslint）的 libdef 相关，用来存放引入一些第三方库或是自定义类型库</p>
</blockquote>
<h3 id="mock"><a href="#mock" class="headerlink" title="mock"></a>mock</h3><blockquote>
<p>存放项目用于模拟的数据</p>
</blockquote>
<h3 id="node-modules"><a href="#node-modules" class="headerlink" title="node_modules"></a>node_modules</h3><blockquote>
<p>安装依赖时自动生成的，用于存放项目依赖包</p>
</blockquote>
<h3 id="src"><a href="#src" class="headerlink" title="src"></a>src</h3><blockquote>
<p>项目源码</p>
</blockquote>
<h3 id="static"><a href="#static" class="headerlink" title="static"></a>static</h3><blockquote>
<p>静态资源，此目录下的文件不会被webpack处理。在webpack打包后，此目录下的文件会默认被直接复制到dist/static/中</p>
</blockquote>
<h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><blockquote>
<p>用于存放测试文件，比如unit单元测试、e2e测试等</p>
</blockquote>
<h3 id="babelrc"><a href="#babelrc" class="headerlink" title=".babelrc"></a>.babelrc</h3><blockquote>
<p>babel配置文件</p>
</blockquote>
<h3 id="editorconfig"><a href="#editorconfig" class="headerlink" title=".editorconfig"></a>.editorconfig</h3><blockquote>
<p>编辑器编码规范配置文件，用于告诉编辑器本项目的一些编码规范，比如用多少个空格</p>
</blockquote>
<h3 id="eslintignore"><a href="#eslintignore" class="headerlink" title=".eslintignore"></a>.eslintignore</h3><blockquote>
<p>ESLint语法检查忽略配置文件，用于配置忽略语法检查的目录文件</p>
</blockquote>
<h3 id="eslintrc"><a href="#eslintrc" class="headerlink" title=".eslintrc"></a>.eslintrc</h3><blockquote>
<p>ESLint规则配置文件，用于语法检查</p>
</blockquote>
<h3 id="flowconfig"><a href="#flowconfig" class="headerlink" title=".flowconfig"></a>.flowconfig</h3><blockquote>
<p>flow（一个 js 静态类型检测器）项目的配置文件</p>
</blockquote>
<h3 id="gitignore"><a href="#gitignore" class="headerlink" title=".gitignore"></a>.gitignore</h3><blockquote>
<p>用于告诉Git系统要忽略掉跟踪哪些文件</p>
</blockquote>
<h3 id="gitkeep"><a href="#gitkeep" class="headerlink" title=".gitkeep"></a>.gitkeep</h3><blockquote>
<p>用于跟踪项目中的空文件（默认情况Git 不跟踪空文件夹）</p>
</blockquote>
<h3 id="gitattributes"><a href="#gitattributes" class="headerlink" title=".gitattributes"></a>.gitattributes</h3><blockquote>
<p>以行为单位设置一个路径下所有文件的属性</p>
</blockquote>
<h3 id="postcssrc-js-postcss-config-js"><a href="#postcssrc-js-postcss-config-js" class="headerlink" title=".postcssrc.js (postcss.config.js)"></a>.postcssrc.js (postcss.config.js)</h3><blockquote>
<p>postcss配置文件</p>
</blockquote>
<h3 id="travis-yml"><a href="#travis-yml" class="headerlink" title=".travis.yml"></a>.travis.yml</h3><blockquote>
<p>Travis CI（持续集成服务）的配置文件，指定了 Travis 的行为，Github 仓库里面，一旦代码仓库有新的 Commit，Travis 就会去找这个文件，执行里面的命令</p>
</blockquote>
<h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><blockquote>
<p>首页静态html，可能是主入口</p>
</blockquote>
<h3 id="LICENSE"><a href="#LICENSE" class="headerlink" title="LICENSE"></a>LICENSE</h3><blockquote>
<p>开源协议</p>
</blockquote>
<h3 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h3><blockquote>
<p>Make（主要用于C语言的项目构建工具，也有些前端开源项目会支持）构建规则</p>
</blockquote>
<h3 id="package-lock-json"><a href="#package-lock-json" class="headerlink" title="package-lock.json"></a>package-lock.json</h3><blockquote>
<p>使用npm安装依赖时自动生成的确切依赖配置文件，用于后续安装或跨机器安装能够生成相同版本的依赖，即使安装的依赖有更新也不影响</p>
</blockquote>
<h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><blockquote>
<p>npm 模块配置文件，用于定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据）</p>
</blockquote>
<h3 id="yarn-lock"><a href="#yarn-lock" class="headerlink" title="yarn.lock"></a>yarn.lock</h3><blockquote>
<p>使用用Yarn CLI 增加／升级／删除依赖时自动生成的确切依赖配置文件，准确存储每个安装的依赖是哪个版本，用于后续安装或跨机器安装能够生成相同版本的依赖</p>
</blockquote>
<h3 id="README-md"><a href="#README-md" class="headerlink" title="README.md"></a>README.md</h3><blockquote>
<p>项目自述说明，用于概述本项目相关信息：是什么、做什么、有什么用、怎么用等</p>
</blockquote>
<h2 id="思维导图版如下："><a href="#思维导图版如下：" class="headerlink" title="思维导图版如下："></a>思维导图版如下：</h2><p><img src="https://raw.githubusercontent.com/w3cmark/blog/master/assets/5bd13302e4b06fc64b2d8e0d.jpg" alt="前端开源项目目录结构图"></p>]]></content>
      <categories>
        <category>其它</category>
      </categories>
      <tags>
        <tag>总结</tag>
      </tags>
  </entry>
  <entry>
    <title>前端开发踩过的坑</title>
    <url>/2018/02/05/frontend-bugs/</url>
    <content><![CDATA[<p>本文用于总结在前端开发中遇到的一些比较杂的坑。比如CORS跨域等等。</p>
<a id="more"></a>

<h2 id="CORS跨域方案"><a href="#CORS跨域方案" class="headerlink" title="CORS跨域方案"></a>CORS跨域方案</h2><p>接到一个前端跨域请求（GET和POST）相关的需求<br>一调试，咦！浏览器提示跨域报错了～<br>简单！让服务端童鞋加上跨域请求头，开启CORS：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Access-Control-Allow-Credentials: true</span><br><span class="line">Access-Control-Allow-Headers: x-requested-with,content-type,x-xsrf-token</span><br><span class="line">Access-Control-Allow-Methods: GET,POST,OPTIONS</span><br><span class="line">Access-Control-Allow-Origin: http://w3cmark.com</span><br></pre></td></tr></table></figure>

<p>⚠️这里有个彩蛋，服务端加跨域请求头要小心，冒号前面如果有空格，会出现浏览器兼容问题，比如火狐浏览器看到的请求没有跨域请求头；再比如在chrome下，可以正常看到有跨域请求头，但如果使用whistle做代理，跨域请求头就丢失了。</p>
<p>以下是错误示范（冒号前面多了个空格）：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Access-Control-Allow-Credentials : true</span><br><span class="line">Access-Control-Allow-Headers : x-requested-with,content-type,x-xsrf-token</span><br><span class="line">Access-Control-Allow-Methods : GET,POST,OPTIONS</span><br><span class="line">Access-Control-Allow-Origin : http://w3cmark.com</span><br></pre></td></tr></table></figure>

<p>服务端设置搞定！前端再次请求，请求响应头带上上面的返回，GET请求顺利过关。。。<br>如果接口需要登录，前端设置请求<code>withCredentials: true</code>，请求就带上cookie，顺利过关。。。<br>再来一个POST请求<br>咦！浏览器多发了一个OPTIONS请求，一查，原来是preflight request，<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Preflight_request" target="_blank" rel="noopener">预校验请求</a></p>
<blockquote>
<p>这里的请求被分成两种：简单请求和复杂请求，只有复杂请求才会发OPTIONS请求，详情介绍移步：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</a></p>
</blockquote>
<p>———-说了那么多坑终于来了—————</p>
<p>因为服务端对请求做登录校验（包括OPTIONS请求），校验通过后，才会给请求加跨域头返回，而OPTIONS请求是无法携带cookie的<br>来自SO的截图：<br><img src="https://user-images.githubusercontent.com/7434649/54797787-99274500-4c90-11e9-876a-0e8b9e93d597.png" alt="image"><br>所以服务端无法接收到cookie，一直认为未登录，导致发OPTIONS请求时浏览器直接报跨域了。</p>
<p><strong>解决方案，服务端不需要对OPTIONS请求做cookie校验的操作</strong></p>
<h2 id="npm-install-时提示sha512错误"><a href="#npm-install-时提示sha512错误" class="headerlink" title="npm install 时提示sha512错误"></a>npm install 时提示sha512错误</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm ERR! code EINTEGRITY</span><br><span class="line">npm ERR! sha512-MKiLiV+I1AA596t9w1sQJ8jkiSr5+ZKi0WKrYGUn6d1Fx+Ij4tIj+m2WMQSGczs5jZVxV339chE8iwk6F64wjA== integrity checksum failed when using sha512: wanted sha512-MKiLiV+I1AA596t9w1sQJ8jkiSr5+ZKi0WKrYGUn6d1Fx+Ij4tIj+m2WMQSGczs5jZVxV339chE8iwk6F64wjA== but got sha512-WXI95kpJrxw4Nnx8vVI90PuUhrQjnNgghBl5tn54rUNKZYbxv+4ACxUzPVpJEtWxKmeDwnQrzjc0C2bYmRJVKg==. (65117 bytes)</span><br><span class="line"></span><br><span class="line">npm ERR! A complete <span class="built_in">log</span> of this run can be found <span class="keyword">in</span>:</span><br></pre></td></tr></table></figure>

<p>这是一个很奇怪的问题，同一个版本的包，不同人安装偶然会出现，出现问题后，删除<code>package-lock.json</code>再重新安装也无法解决（有时候一开始就报错，都没有生成<code>package-lock.json</code>文件）。</p>
<p>尝试 <code>npm cache clean --force</code> 清除npm缓存，这是网上搜索出来的方案，但试过无效。</p>
<p><strong>解决方案：</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 关闭npm的https</span></span><br><span class="line">npm config <span class="built_in">set</span> Strict-ssl <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>然后再重新安装就正常了</p>]]></content>
      <categories>
        <category>bugs</category>
      </categories>
      <tags>
        <tag>cors</tag>
        <tag>bug</tag>
      </tags>
  </entry>
  <entry>
    <title>Laraval-nova入门安装</title>
    <url>/2017/12/26/laraval-nova/</url>
    <content><![CDATA[<p>最近在接触基于PHP框架laraval的一个nova项目，它 <a href="https://laravel-china.org/index.php/docs/nova/1.0/install/2186" target="_blank" rel="noopener">官方文档</a> 在介绍安装有些步骤不是很详细，所以记录一下整个安装流程：</p>
<a id="more"></a>

<p>1、需要确保安装mysql、php、composer环境</p>
<p>2、安装laraval框架，通过larval框架创建新project项目</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 安装laraval</span><br><span class="line">composer global require &quot;laravel/installer&quot;</span><br><span class="line"> </span><br><span class="line"># 创建名字为blog项目</span><br><span class="line">laravel new blog</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 如果提示laraval命令没找到，需要设置环境变量，比如mac下：</span><br><span class="line">vim ~/.zshrc</span><br><span class="line"># 添加以下path</span><br><span class="line">export PATH=&quot;$HOME/.composer/vendor/bin:$PATH&quot;</span><br></pre></td></tr></table></figure>

<p>3、进入创建好的新project项目，修改composer.json文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 新加repositories字段</span><br><span class="line">&quot;repositories&quot;: [ </span><br><span class="line">    &#123;</span><br><span class="line">        &quot;type&quot;: &quot;path&quot;,</span><br><span class="line">        &quot;url&quot;: &quot;./nova&quot; // 下载源码解压后存放的相对路径</span><br><span class="line">    &#125;</span><br><span class="line">],</span><br><span class="line"> </span><br><span class="line">// 修改require字段</span><br><span class="line">&quot;require&quot;: &#123;</span><br><span class="line">    …</span><br><span class="line">    &quot;laravel/nova&quot;: &quot;*&quot; // 新加</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>4、修改<code>composer.json</code>文件后，按顺序执行：</p>
<p>执行 <code>composer update</code></p>
<p>执行 <code>php artisan nova:install</code></p>
<p>5、本地数据库创建 </p>
<p>修改<code>.env</code>文件里面数据库相关信息，比如数据库名、用户名、密码</p>
<p>执行 <code>php artisan migrate</code></p>
<p>（本人测试发现在mysql8.xx版本会出现连接报错，暂时没能解决，连接5.xx的mysql没问题）</p>
<p>但是又遇到<code>Unknown character set: &#39;utf8mb4&#39;</code>报错，解决方案是修改项目里的 <code>/config/database.php</code></p>
<p><img src="https://raw.githubusercontent.com/w3cmark/blog/master/assets/laraval_nova.png" alt="laraval_nova.png"> </p>
<p>6、创建用户（用于访问时的登录）</p>
<p><code>php artisan nova:user</code></p>
<p>7、启动服务 <code>php artisan serve</code></p>
<p>访问路径 <code>http://127.0.0.1:8000/nova/</code></p>
<p>即可看到后台界面啦</p>]]></content>
      <categories>
        <category>其它</category>
      </categories>
      <tags>
        <tag>laraval</tag>
      </tags>
  </entry>
  <entry>
    <title>推荐两个非常好用的夸克网盘影视资源站点</title>
    <url>/2024/10/08/kuakes/</url>
    <content><![CDATA[<p>今天给大家分享两个非常好用的夸克网盘影视资源小站点，都是无套路获取的（真的很讨厌那种要登录、要关注微信公众号，甚至还要付费才能获取分享链接的站点）喜欢白嫖影视资源的童鞋可以关注，低调传播～</p>
<a id="more"></a>

<h2 id="站点一：爱盘资源"><a href="#站点一：爱盘资源" class="headerlink" title="站点一：爱盘资源"></a>站点一：爱盘资源</h2><p><img src="/images/ipzy.png" alt="ipzy"></p>
<p>是一个清新小论坛，主要是分析夸克网盘资源，包括：电影、电视剧、动漫、纪录片、音乐、综艺、电子书、学习资料等资源。<br>截止目前，有6000多篇帖子，资源算不上多，但贵在新资源有持续更新，资源失效反馈后也会很快有反馈，说明还是有人在维护的。<br>里面还有微信社群，特别适合每天追剧的人，每天都会及时更新，让你第一时间免费获取到最新资源。</p>
<p>站点域名：<a href="https://ipzy.cc" target="_blank" rel="noopener">https://ipzy.cc</a></p>
<h2 id="站点二：夸克网盘社"><a href="#站点二：夸克网盘社" class="headerlink" title="站点二：夸克网盘社"></a>站点二：夸克网盘社</h2><p><a href="https://ipzy.cc" target="_blank" rel="noopener">爱盘资源</a>站点，有个不太好的地方，就是资源描述太少，又没有图片，除非你很清楚知道自己要找的资源是什么，不然不太友好。<br>所以，我又关注了另外一个：<a href="https://kuakes.com" target="_blank" rel="noopener">夸克网盘社</a>。<br>看名字就知道，也是一个专门分享夸克网盘资源的站点（个人是夸克的忠实使用者，相比其它网盘，夸克给的空间多，而且影视资源最丰富了）</p>
<p><a href="https://kuakes.com" target="_blank" rel="noopener">夸克网盘社</a>是一个很新的站点，它对每个资源都有图片和详细介绍，资源类型也很多。</p>
<p>站点域名：<a href="https://kuakes.com" target="_blank" rel="noopener">https://kuakes.com</a></p>]]></content>
      <categories>
        <category>夸克</category>
      </categories>
      <tags>
        <tag>夸克</tag>
        <tag>夸克网盘</tag>
        <tag>影视资源</tag>
      </tags>
  </entry>
  <entry>
    <title>Python入门积累</title>
    <url>/2018/01/20/python-getting-started/</url>
    <content><![CDATA[<p>最近在学习Python，本文用来记录学习过程中觉得值得记录的知识点，以备复习。</p>
<a id="more"></a>

<h3 id="用处"><a href="#用处" class="headerlink" title="用处"></a>用处</h3><ul>
<li><p>web网站和各种网络服务</p>
</li>
<li><p>系统工具和脚本</p>
</li>
<li><p>作为“胶水”语言把其他语言开发的模块包装起来方便使用</p>
</li>
</ul>
<h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><ul>
<li><p>解析型语言，执行速度比 c（编译成机器码）/java（编译成字节码） 都慢</p>
</li>
<li><p>源码不能加密</p>
</li>
<li><p>代码量少，开发速度快</p>
</li>
</ul>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li><p>版本兼容问题，2.7和3.3代码存在不兼容的情况</p>
</li>
<li><p>如果中文字符串在Python环境下遇到 UnicodeDecodeError，这是因为.py文件保存的格式有问题。可以在第一行添加注释</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>让loading效果更线性</title>
    <url>/2017/12/20/loading-effect-more-linear/</url>
    <content><![CDATA[<p>为了提高用户体验，在做一些比较多资源的项目，我们经常会用资源预加载的方式，一打开页面会先看到一个loading动画效果或者loading进度条，再或者加载百分比，用来暗示用户，页面资源比较多，正在加载中啦，你再等等哈，不要走喔。。。</p>
<a id="more"></a>

<p>而这里的资源预加载，就是通过js去预先请求某些资源，以备页面展示时可以直接使用，比如图片预加载，我们可能会这样实现：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// 加载成功...</span></span><br><span class="line">&#125;;</span><br><span class="line">img.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// 加载出错...</span></span><br><span class="line">&#125;;</span><br><span class="line">img.src = <span class="string">'https://dummyimage.com/90x90/ddd/79c'</span>;</span><br></pre></td></tr></table></figure>

<p>通过创建一个不可见的img来触发图片请求，上面演示的只是加载一张，一般情况做预加载都会有多资源才做啦，所以批量预加载只需要加入循环：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> iFileData = [<span class="comment">//预加载图片资源</span></span><br><span class="line">        <span class="string">'https://dummyimage.com/90x90/ddd/79c'</span>,</span><br><span class="line">        <span class="string">'https://dummyimage.com/100x100/ddd/79c'</span>,</span><br><span class="line">        <span class="string">'https://dummyimage.com/200x200/ddd/79c'</span>,</span><br><span class="line">        <span class="string">'https://dummyimage.com/300x300/ddd/79c'</span>,</span><br><span class="line">        <span class="string">'https://dummyimage.com/400x400/ddd/79c'</span>,</span><br><span class="line">        <span class="string">'https://dummyimage.com/500x500/ddd/79c'</span></span><br><span class="line">    ],</span><br><span class="line">	_total = iFileData.length,</span><br><span class="line">	_loaded = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; _total; i++) &#123;</span><br><span class="line">    loadImage(iFileData);</span><br><span class="line">&#125;</span><br><span class="line">loadImage = <span class="function"><span class="keyword">function</span>(<span class="params">iData</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">    img.onload = img.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        _loaded++;</span><br><span class="line">        checkLoadComplete();</span><br><span class="line">    &#125;;</span><br><span class="line">    img.src = iData;</span><br><span class="line">&#125;,</span><br><span class="line">checkLoadComplete = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(_loaded == _total) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'加载完毕'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>上面可以实现简单的预加载了，但好像没有当前加载的进度喔<br>下面加上一个当前加载进度的百分比：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">checkLoadComplete = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> per = (_loaded/_total).toFixed(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span>(per &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        per = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'当前加载进度：'</span> + per);</span><br><span class="line">    <span class="keyword">if</span>(_loaded == _total) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'加载完毕'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>到这，资源预加载的功能基本就ok了，然后展示进度跟进上面的进度返回，转成数字百分比或者一个进度条就可以了。<br>另外，这个功能很常用，可以再做一下封装，方便使用，还可以加入其它资源的支持，比如多媒体文件？</p>
<p>完了？<br>但，这个不是本文的重点，本文的重点是<code>线性</code>。</p>
<h3 id="改良，让加载更线性"><a href="#改良，让加载更线性" class="headerlink" title="改良，让加载更线性"></a>改良，让加载更线性</h3><p>上面的预加载有个问题，体验不好。比如，你要预加载10个资源，显示的百分比就是0%，10%，20%，30%…这样10个数字的跳动，极端点，当你只有一个资源（当然这里是极端考虑，像前文说的，一个资源，你估计不会用预加载了）时，进度就是0%~100%，一下就从0跳到100了。</p>
<p>还有，即使是10个资源，当用户第二次打开页面，因为资源有缓存，这个loading效果就会可能一闪而过，因为有缓存加载太快了，进度都看不清就没了，体验也不好（或者即使第一次，如果用户网速很好，也会出现一闪而过）。</p>
<p>所以，上面的预加载体验不够好，不稳定，导致动画效果不线性。</p>
<p>预想的线性是怎样的呢？比如进度百分比数字，我预想的是无论多少资源，第几次打开，网速如何，都是从0%，1%，2%，3%，4%，5%，6%….这样直到100的，只有这样，数字展示才不会大幅度跳动或者进度条的宽度才不会跳跃。</p>
<p>那怎么达到这样的数字累加效果呢？咦？累加？那可以用定时器啊：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> _num_interval = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    _num++;</span><br><span class="line">    <span class="keyword">if</span>(_num &gt; <span class="number">99</span>)&#123;</span><br><span class="line">        clearInterval(_num_interval);</span><br><span class="line">        _num = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(_num);</span><br><span class="line">&#125;, <span class="number">50</span>)</span><br></pre></td></tr></table></figure>

<p>嗯，这样数字就不跳动啦，很线性！！从0<del>100，每隔50毫秒加1，到100就停止，so easy</del></p>
<p>线性数字有了，但和我加载进度有毛关系？而且资源加载是会根据网速不同而不同，这50毫秒。。。假的进度，明显不行啊</p>
<p>第一个问题，线性数字和实际资源加载联系起来，这个还是很容易的。从第一个资源开始，就同时触发触发上面的计时器，当最后一个资源加载完而且计算到100了，就完成了预加载过程。</p>
<p>第二个问题，定时器的时间怎么和实际资源加载联系起来呢？定时器先根据资源数定一个初始值，加载过程通过把假的计算进度和真实的加载进度进行比较，实时调整定时器的时间，以达到尽可能的模拟实际进度：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _time = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">var</span> linearLoad = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(_num_interval)&#123;</span><br><span class="line">        clearInterval(_num_interval);</span><br><span class="line">    &#125;</span><br><span class="line">    _num_interval = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        _num++;</span><br><span class="line">        <span class="keyword">if</span>(_num &gt; <span class="number">99</span> &amp;&amp; (_loaded == _total))&#123;</span><br><span class="line">            clearInterval(_num_interval);</span><br><span class="line">            _num = <span class="number">100</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(_num);</span><br><span class="line">            <span class="comment">// 加载完毕</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'加载完毕'</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(_num &gt; <span class="number">99</span>)&#123;</span><br><span class="line">            clearInterval(_num_interval);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(_num);</span><br><span class="line">        <span class="keyword">if</span>(_time &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            adjustSpeed(_time_range);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, _time)</span><br><span class="line">&#125;,</span><br><span class="line">adjustSpeed = <span class="function"><span class="keyword">function</span>(<span class="params">range</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//调节数字变化速度</span></span><br><span class="line">    <span class="keyword">var</span> per = (_loaded/_total).toFixed(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">parseInt</span>(per*<span class="number">100</span>) &gt; _num)&#123;</span><br><span class="line">        <span class="comment">//如果实际加载速度快，提高线性数字速度</span></span><br><span class="line">        _time = _time - range;</span><br><span class="line">        _time = _time &lt; <span class="number">1</span> ? <span class="number">1</span> : _time;</span><br><span class="line">        linearLoad();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//如果实际加载慢，降低线性数字速度</span></span><br><span class="line">        _time = _time + range;</span><br><span class="line">        linearLoad();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>逻辑细节请移步测试demo：<a href="http://www.w3cmark.com/staticdemo/loading/" target="_blank" rel="noopener">http://www.w3cmark.com/staticdemo/loading/</a></p>
<h3 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h3><p><img src="https://raw.githubusercontent.com/w3cmark/blog/master/assets/loading.gif" alt="loading.gif"></p>]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>总结</tag>
      </tags>
  </entry>
  <entry>
    <title>陌生的HTML标签</title>
    <url>/2018/01/25/unfamiliar-html-tags/</url>
    <content><![CDATA[<p>从刚入门前端时，从table年代到div年代，很多实际的HTML开发基本都停留在几个常用的标签，比如html、head、body、div、meta、a、p、span、i、em、img、canvas、video、audio、h1、h2…<br>而有很多相对于我来说，是很少用甚至没用过的标签。</p>
<a id="more"></a>

<h3 id="SVG预定义的形状元素标签"><a href="#SVG预定义的形状元素标签" class="headerlink" title="SVG预定义的形状元素标签"></a>SVG预定义的形状元素标签</h3><blockquote>
<p>这些标签不熟，说明svg不熟</p>
</blockquote>
<ul>
<li>矩形 <code>&lt;rect&gt;</code></li>
<li>圆形 <code>&lt;circle&gt;</code></li>
<li>椭圆 <code>&lt;ellipse&gt;</code></li>
<li>线 <code>&lt;line&gt;</code></li>
<li>折线 <code>&lt;polyline&gt;</code></li>
<li>多边形 <code>&lt;polygon&gt;</code></li>
<li>路径 <code>&lt;path&gt;</code></li>
</ul>
<h3 id="lt-figure-gt-、-lt-figcaption-gt"><a href="#lt-figure-gt-、-lt-figcaption-gt" class="headerlink" title="&lt;figure&gt;、&lt;figcaption&gt;"></a><code>&lt;figure&gt;</code>、<code>&lt;figcaption&gt;</code></h3><p><code>&lt;figure&gt;</code>：用作文档中插图的图像<br><code>&lt;figcaption&gt;</code>：figure插图里如果带有一个标题可以使用</p>]]></content>
      <categories>
        <category>HTML</category>
      </categories>
      <tags>
        <tag>html</tag>
        <tag>tags</tag>
      </tags>
  </entry>
  <entry>
    <title>小程序开发遇到的坑</title>
    <url>/2017/12/24/small-program-bugs/</url>
    <content><![CDATA[<p>做了一小段时间的微信小程序开发，踩了不少坑，在这里做一下总结：</p>
<a id="more"></a>

<h4 id="1、在-app-js-的-onShow-和-onHide-时-getCurrentPages-查询页面栈，可能获取到空数组"><a href="#1、在-app-js-的-onShow-和-onHide-时-getCurrentPages-查询页面栈，可能获取到空数组" class="headerlink" title="1、在 app.js 的  onShow 和 onHide 时 getCurrentPages() 查询页面栈，可能获取到空数组"></a>1、在 <code>app.js</code> 的  <code>onShow</code> 和 <code>onHide</code> 时 <code>getCurrentPages()</code> 查询页面栈，可能获取到空数组</h4><p>发现时间：20180517</p>
<p>系统环境：IOS </p>
<blockquote>
<p>如果有在这两个场景使用，建议对当前页面对象进行判断是否为<code>undefined</code></p>
</blockquote>
<h4 id="2、tabBar页面-wx-getSystemInfo-的-windowHeight-小于实际高度（大约少了一个tabBar的距离）"><a href="#2、tabBar页面-wx-getSystemInfo-的-windowHeight-小于实际高度（大约少了一个tabBar的距离）" class="headerlink" title="2、tabBar页面 wx.getSystemInfo 的 windowHeight 小于实际高度（大约少了一个tabBar的距离）"></a>2、tabBar页面 <code>wx.getSystemInfo</code> 的 <code>windowHeight</code> 小于实际高度（大约少了一个tabBar的距离）</h4><p>发现时间：20180517</p>
<p>系统环境：android部分机</p>
<h4 id="3、tabBar页面Page的onTabItemTap事件在首次切换不会触发，要在页面onShow后再切换才触发"><a href="#3、tabBar页面Page的onTabItemTap事件在首次切换不会触发，要在页面onShow后再切换才触发" class="headerlink" title="3、tabBar页面Page的onTabItemTap事件在首次切换不会触发，要在页面onShow后再切换才触发"></a>3、tabBar页面Page的<code>onTabItemTap</code>事件在首次切换不会触发，要在页面<code>onShow</code>后再切换才触发</h4><p>发现时间：20180517</p>
<p>系统环境：iOS</p>
<blockquote>
<p>sdk 1.9.97有问题、更新到2.0.7正常</p>
</blockquote>
<h4 id="4、button的border无法去掉？"><a href="#4、button的border无法去掉？" class="headerlink" title="4、button的border无法去掉？"></a>4、button的border无法去掉？</h4><p>小程序的<code>open-type</code>是<code>button</code>特有的属性，所以使用小程序原生<code>button</code>组件在所难免，比如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;button open-type=&quot;share&quot; class=&quot;btn&quot;&gt;</span><br><span class="line">    点击分享</span><br><span class="line">&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<p>但是原生的<code>button</code>可能不太适合业务，所以需要去掉默认样式，比如去掉背景色和边框：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.btn &#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">    border: 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>咦！意不意外？背景是去掉了，边框还在。。。<br>原来原生<code>button</code>的边框是写在 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/::after" target="_blank" rel="noopener">伪元素</a> <code>after</code>的，所以，需要这样才能去掉：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.btn::after &#123;</span><br><span class="line">    border: 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、canvas-draw回调一直不执行，也没报错（sdk在1-7-1以上都不可以）"><a href="#5、canvas-draw回调一直不执行，也没报错（sdk在1-7-1以上都不可以）" class="headerlink" title="5、canvas.draw回调一直不执行，也没报错（sdk在1.7.1以上都不可以）"></a>5、<code>canvas.draw</code>回调一直不执行，也没报错（sdk在1.7.1以上都不可以）</h4><blockquote>
<p><a href="https://developers.weixin.qq.com/community/develop/doc/000a2452278da84dbc76b2bcf5b400" target="_blank" rel="noopener">前往社区类似问题反馈</a></p>
</blockquote>
<p>如果你用了很多方式也排查不出原因，可以试下把绘画的<code>canvas</code>标签放到<code>page</code>页面级别的<code>html</code>，而不是放到自定义的组件<code>html</code>。貌似放到自定义组件，无法找到画布，导致绘画不成功（它没报错，但回调又不执行）。</p>
<p>回头看来<a href="https://developers.weixin.qq.com/miniprogram/dev/api/canvas/wx.createCanvasContext.html" target="_blank" rel="noopener">官方api</a>，原来<code>createCanvasContext</code>方法有第二个参数 <code>Object this</code>，</p>
<blockquote>
<p>在自定义组件下，当前组件实例的this，表示在这个自定义组件下查找拥有 canvas-id 的 <canvas> ，如果省略则不在任何自定义组件内查找</canvas></p>
</blockquote>]]></content>
      <categories>
        <category>小程序</category>
      </categories>
      <tags>
        <tag>bugs</tag>
      </tags>
  </entry>
  <entry>
    <title>【译】使用CSS开发SVG动画</title>
    <url>/2018/06/29/translate-animating-svg-with-css/</url>
    <content><![CDATA[<blockquote>
<p>本文采用意译<br>原文：<a href="https://blog.logrocket.com/animating-svg-with-css-83e8e27d739c/" target="_blank" rel="noopener">Animating SVG with CSS</a></p>
</blockquote>
<p><img src="https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2019/04/1_-mL-Y_OA9L_GvrKpKxrvpA.png?w=1600&ssl=1" alt="image"></p>
<a id="more"></a>

<p>动画是网页内很有趣的一部分。它们可以改善用户体验，因为它们可以提供视觉反馈，任务指引和为网站添加动感。这里有几种方法可以创建Web动画，比如JavaScript库，GIF和嵌入式视频。但SVG和CSS的简单组合很有吸引力，原因有几个。首先由代码实现而不是数千个图像帧组成的它们具有高性能，并且比庞大的GIF和视频具有更快的加载时间。此外，它们还可以创建许多简单的动画，而无需在网页加载中另一个JavaScript插件。最重要的是，SVG是基于矢量的，因此它们可以在不同屏幕尺寸上完美缩放，而不会产生失真。</p>
<p>现在，你可能想知道：为什么选择CSS？ 为什么不使用原生SVG动画规范<a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/SVG_animation_with_SMIL" target="_blank" rel="noopener">SMIL</a>进行动画制作？ 事实证明，SMIL的支持率正在下降。 Chrome（Chrome 45已经弃用）正朝着弃用SMIL的方向发展，转而采用CSS动画和Web Animations API。 所以，我们继续使用CSS动画……但它们是如何制作的？ 在本文中，我们将学习如何制作这些轻量级，可扩展的动画！</p>
<h2 id="使用CSS制作SVG动画的常见例子"><a href="#使用CSS制作SVG动画的常见例子" class="headerlink" title="使用CSS制作SVG动画的常见例子"></a>使用CSS制作SVG动画的常见例子</h2><p>首先，让我们看一下在Web应用程序或登录页面中为什么需要SVG动画的实际例子。</p>
<h3 id="图标（Icons）"><a href="#图标（Icons）" class="headerlink" title="图标（Icons）"></a>图标（Icons）</h3><p>SVG动画非常适合指引交互和状态变化的图标。 在引导用户进行下一个操作时，例如在上手指引中，它们也很有用。 常见用例包括加载，上传，菜单切换以及播放/暂停视频。</p>
<h3 id="插图（Illustrations）"><a href="#插图（Illustrations）" class="headerlink" title="插图（Illustrations）"></a>插图（Illustrations）</h3><p>插图是另一个常见的用例。在产品中，它们可以用来演示如何在仪表板上从空白状态生成数据。 而动画表情符号和贴纸也是其他流行的用例。 此外，还有动画现场插图，可以在制作品牌登陆页面时增加立体感和乐趣。</p>
<h2 id="如何准备SVG"><a href="#如何准备SVG" class="headerlink" title="如何准备SVG"></a>如何准备SVG</h2><p>现在，让我们深入了解细节。 你要做的第一件事就是准备一个SVG。 当你因为准备的SVG变得复杂而变成一个狂躁的动画专家时，再开始简化可能会很烦人，但是从简化的SVG代码开始会更容易。</p>
<h3 id="简化SVG代码"><a href="#简化SVG代码" class="headerlink" title="简化SVG代码"></a>简化SVG代码</h3><p>创建SVG时，它有些额外的代码，通常是不必要的。 因此，优化它非常重要。 我喜欢使用<a href="https://github.com/svg/svgo" target="_blank" rel="noopener">SVGO</a>来减少文件大小并使用唯一ID保存路径（这对于防止同一页面上的多个SVG出现问题非常重要）。 SVGO是一个Node.js工具，有几种方法可以使用它，包括Sketch插件：SVGO Compressor。</p>
<h3 id="创建有意的分组（如果需要）"><a href="#创建有意的分组（如果需要）" class="headerlink" title="创建有意的分组（如果需要）"></a>创建有意的分组（如果需要）</h3><p>在代码编辑器中打开SVG文件，并注意 <code>&lt;g&gt;</code> 元素。 这些元素是用于分组SVG元素。 如果要将一组元素设置为动画，请将它们包装在 <code>&lt;g&gt; &lt;/g&gt;</code> 中，并使用 <code>class</code> 或 <code>ID</code> 命名它们。 如果你希望以相同方式设置多个形状（ID只能使用一次），请考虑将ID名称转换为class名称。 一旦你在形状上有了ID或类，你就可以用CSS来定位它们。 保存SVG时，暂时不会有任何明显的变化。</p>
<h3 id="小心堆叠顺序（如果你要为另一个形状后面的形状设置动画）"><a href="#小心堆叠顺序（如果你要为另一个形状后面的形状设置动画）" class="headerlink" title="小心堆叠顺序（如果你要为另一个形状后面的形状设置动画）"></a>小心堆叠顺序（如果你要为另一个形状后面的形状设置动画）</h3><p>这似乎是违反常识的，但最后列出的形状将粘贴在所有形状上。 因此，如果你希望在背景中显示形状，请确保它放在在SVG代码的顶部。 SVG形状从上到下依次“绘制”。</p>
<h3 id="将SVG样式设置为首选的初始状态"><a href="#将SVG样式设置为首选的初始状态" class="headerlink" title="将SVG样式设置为首选的初始状态"></a>将SVG样式设置为首选的初始状态</h3><p>SVG具有类似于CSS样式的表现属性，但是是直接在SVG标签上设置的。 一个常见的例子是填充颜色。 由于这些样式是在SVG标签上设置的，因此你可能认为它们在浏览器中具有很高权重。 但事实证明，你在外部设置的任何<code>CSS / Sass</code>都会正常地覆盖SVG样式，而不需要<code>！important</code>声明。 但是，你需要注意SVG上设置的内容，以便为页面加载期间显示的内容做好准备。 对于加载缓慢的页面，你可能会在通过CSS设置样式之前看到SVG闪现。 我建议你预留位置，以避免在页面加载过程中无样式闪现的SVG（<a href="https://www.sarasoueidan.com/blog/svg-style-inheritance-and-fousvg/" target="_blank" rel="noopener">Sara Soueidan在这篇文章里很好地解释了无样式SVG的闪现（FOUSVG）</a>）。</p>
<h2 id="把CSS应用于SVG"><a href="#把CSS应用于SVG" class="headerlink" title="把CSS应用于SVG"></a>把CSS应用于SVG</h2><p>现在你已经拥有了整洁的SVG代码，让我们开始介绍如何引入CSS。 关于如何将CSS应用于SVG，需要考虑一些因素。 有个限制是你无法使用外链的样式将样式应用于外链的SVG。</p>
<h3 id="方法一：在HTML中嵌入SVG代码（我最喜欢的）"><a href="#方法一：在HTML中嵌入SVG代码（我最喜欢的）" class="headerlink" title="方法一：在HTML中嵌入SVG代码（我最喜欢的）"></a>方法一：在HTML中嵌入SVG代码（我最喜欢的）</h3><p>这使得SVG元素及其内容成为文档DOM树的一部分，因此它们受到文档CSS的影响。 这是我的最喜欢的方式，因为它使样式与标签分开。</p>
<p>在下面的其他方法中，你会看到它们是相互缠绕的。 如果你正在使用<a href="https://ruby-china.github.io/rails-guides/getting_started.html" target="_blank" rel="noopener">Rails</a>，那么有些插件可以自动将SVG嵌入到视图中。 因此，在你的代码中，你可以简单地引用外部SVG，然后在编译时嵌入它。 此方法的另一个好处是内联SVG意味着减少一个HTTP请求。 例子：</p>
<iframe name="cp_embed_1" src="https://codepen.io/lukelogrocket/embed/NmLQdz?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=lukelogrocket&amp;slug-hash=NmLQdz&amp;pen-title=SVG%20-%201&amp;name=cp_embed_1" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG - 1" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_NmLQdz"></iframe>

<h3 id="方法2：在SVG中插入带有CSS的-lt-style-gt-标签"><a href="#方法2：在SVG中插入带有CSS的-lt-style-gt-标签" class="headerlink" title="方法2：在SVG中插入带有CSS的&lt;style&gt;标签"></a>方法2：在SVG中插入带有CSS的<code>&lt;style&gt;</code>标签</h3><p>你可以在<code>&lt;style&gt;</code>标签中添加CSS样式，然后嵌套在<code>&lt;svg&gt;</code>标签内。例子：</p>
<iframe name="cp_embed_2" src="https://codepen.io/lukelogrocket/embed/axaeWO?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=lukelogrocket&amp;slug-hash=axaeWO&amp;pen-title=SVG%20-%202&amp;name=cp_embed_2" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG - 2" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_axaeWO"></iframe>

<h3 id="方法3：使用外部链接在SVG中包含CSS"><a href="#方法3：使用外部链接在SVG中包含CSS" class="headerlink" title="方法3：使用外部链接在SVG中包含CSS"></a>方法3：使用外部链接在SVG中包含CSS</h3><p>如果你希望保留SVG中引用的样式，但又不想把样式包含在SVG标签内，则可以使用<code>&lt;？xml-stylesheet&gt;</code>标签引入外部样式表。例子：</p>
<iframe name="cp_embed_3" src="https://codepen.io/lukelogrocket/embed/qwMejZ?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=lukelogrocket&amp;slug-hash=qwMejZ&amp;pen-title=SVG%20-%203&amp;name=cp_embed_3" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG - 3" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_qwMejZ"></iframe>

<h3 id="方法4：在SVG中使用内联CSS样式"><a href="#方法4：在SVG中使用内联CSS样式" class="headerlink" title="方法4：在SVG中使用内联CSS样式"></a>方法4：在SVG中使用内联CSS样式</h3><p>也可以使用内联样式属性<code>style</code>直接在元素上设置CSS。</p>
<iframe name="cp_embed_4" src="https://codepen.io/lukelogrocket/embed/EJeqva?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=lukelogrocket&amp;slug-hash=EJeqva&amp;pen-title=SVG%20-%204&amp;name=cp_embed_4" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG - 4" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_EJeqva"></iframe>

<h2 id="哪些可以用CSS动画？"><a href="#哪些可以用CSS动画？" class="headerlink" title="哪些可以用CSS动画？"></a>哪些可以用CSS动画？</h2><p>实际上很多！ 具有可随时间变化的值的CSS属性都可以使用CSS动画或CSS过渡进行动画处理（有关这些属性的完整列表，请参阅MDN Web Doc的<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_animated_properties" target="_blank" rel="noopener">CSS动画属性列表</a>）。 以下是一些Demo演示。</p>
<h2 id="Demos"><a href="#Demos" class="headerlink" title="Demos"></a>Demos</h2><p>我们将介绍两种主要类型的动画，它们根据提供的控制量而有所不同。 注意：我将在demo中使用<code>Sass</code>，当然它也适用于CSS。 另外，为了简单起见，我省略了浏览器前缀，可能你实际项目中需要添加这些前缀（稍后会详细介绍）。</p>
<h3 id="过度属性"><a href="#过度属性" class="headerlink" title="过度属性"></a>过度属性</h3><p>你可以在加载时触发的动画或通过状态更改（例如<code>hover</code>或<code>click</code>）时使用过渡属性。 <code>transition</code>属性允许属性值在指定的持续时间内平滑变化。 没有它，这种变化会在瞬间发生，从而产生一种唐突的现象。</p>
<h4 id="Transition-属性"><a href="#Transition-属性" class="headerlink" title="Transition 属性"></a><code>Transition</code> 属性</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">property</span> <span class="selector-tag">duration</span> <span class="selector-tag">timing-function</span> <span class="selector-tag">delay</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>transition</td>
<td>一次性设置所有四个的简写属性</td>
</tr>
<tr>
<td>transition-delay</td>
<td>过度效果的延迟（以秒为单位）</td>
</tr>
<tr>
<td>transition-duration</td>
<td>过度效果完成所需的秒数或毫秒数</td>
</tr>
<tr>
<td>transition-property</td>
<td>指定过度效果作用的CSS属性的名称</td>
</tr>
<tr>
<td>transition-timing-function</td>
<td>过渡效果的速度曲线</td>
</tr>
</tbody></table>
<h4 id="悬停时变换的示例"><a href="#悬停时变换的示例" class="headerlink" title="悬停时变换的示例"></a>悬停时变换的示例</h4><iframe name="cp_embed_5" src="https://codepen.io/hopearmstrong/embed/LrQyRG?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=hopearmstrong&amp;slug-hash=LrQyRG&amp;pen-title=SVG%20Donut%20Animated%20on%20Hover%20with%20CSS%20%2F%20Sass&amp;name=cp_embed_5" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG Donut Animated on Hover with CSS / Sass" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_LrQyRG"></iframe>

<p>这款使用了过度效果的迷幻甜甜圈可以让变色更加好看自然！ <code>#donut-icing</code>元素的转换告诉填充使用<code>ease-out</code>淡出缓动函数在三秒内逐渐改变。 鼠标悬停状态会触发填充变为蓝色。 中间发生的是一种很酷的混色，有一点点紫色。</p>
<h3 id="动画属性"><a href="#动画属性" class="headerlink" title="动画属性"></a>动画属性</h3><p>过渡属性的限制是它不能很好地控制在时间线期间发生的变化。 对于从A点到B点简单的动画来说更好。为了进一步控制，请使用<code>Animation</code>属性。 这些属性可以单独使用，但我这里演示的是简写动画属性。</p>
<h4 id="Animation-属性"><a href="#Animation-属性" class="headerlink" title="Animation 属性"></a><code>Animation</code> 属性</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">animation: name duration timing-function delay iteration-count direction fill-mode play-state;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>animation-name</td>
<td>动画关键帧的名称。当您阅读下面的关键帧部分时，请留意这一点。</td>
</tr>
<tr>
<td>animation-duration</td>
<td>动画的长度，以秒或毫秒为单位。注意：请必须指定<code>animation-duration</code>属性。否则持续时间默认为0，永远不会播放。</td>
</tr>
<tr>
<td>animation-timing-function</td>
<td>动画的速度曲线。例如：<code>linear</code>, <code>ease</code>, <code>ease-in</code>, <code>ease-out</code>, <code>ease-in-out</code>, <code>step-start</code>, <code>step-end</code>, `steps(int,start</td>
</tr>
<tr>
<td>animation-delay</td>
<td>以秒（s）或毫秒（ms）为单位，它是动画开始之前的延迟时间。注意：如果给定负值，它将立即播放，就像它已经播放了一段时间一样。</td>
</tr>
<tr>
<td>animation-iteration-count</td>
<td>应播放动画的次数。例如：任何数字</td>
</tr>
<tr>
<td>animation-direction</td>
<td>以反向或交替循环播放动画。例如：<code>normal</code>, <code>reverse</code>, <code>alternate</code>, <code>alternate-reverse</code>, <code>initial</code>, <code>inherit</code></td>
</tr>
<tr>
<td>animation-fill-mode</td>
<td>动画在执行之前和之后如何将样式应用于其目标，比如<code>forwards</code>、<code>backwards</code>、<code>both</code></td>
</tr>
<tr>
<td>animation-play-state</td>
<td>指定动画是正在运行还是暂停状态</td>
</tr>
<tr>
<td>initial</td>
<td>默认值</td>
</tr>
<tr>
<td>inherit</td>
<td>从父级继承</td>
</tr>
</tbody></table>
<h4 id="关键帧（Keyframes）"><a href="#关键帧（Keyframes）" class="headerlink" title="关键帧（Keyframes）"></a>关键帧（Keyframes）</h4><p>这是令人兴奋的地方，这就是在时序控制方面将动画与过渡属性区分开来的原因。 使用<code>@keyframes</code> 声明告诉它如何在中间步骤进行更改。 要使用关键帧，请添加一个<code>@keyframes</code> 声明，其名称与所需的<code>animation-name</code>属性相匹配。 使用关键帧选择器指定应在何时进行更改的动画时间轴上的百分比。</p>
<p>下面是一个显示百分比选择器的示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@keyframes name-goes-here</span><br><span class="line">  0%</span><br><span class="line">    width: 100px</span><br><span class="line">  25%</span><br><span class="line">    width: 120px</span><br><span class="line">  50%, 75%</span><br><span class="line">    width: 130px</span><br><span class="line">  100%</span><br><span class="line">    width: 110px</span><br></pre></td></tr></table></figure>

<p>如果要仅为开头和结尾创建关键帧，可以这样做：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@keyframes name-goes-here</span><br><span class="line">  from</span><br><span class="line">    width: 100px</span><br><span class="line">  to</span><br><span class="line">    width: 120px</span><br></pre></td></tr></table></figure>

<p>虽然关键帧可以在你将它们放入样式表的任何位置运行，但它们通常位于动画属性下方，可以轻松找到它们的引用。</p>
<h3 id="变换（Transforms）"><a href="#变换（Transforms）" class="headerlink" title="变换（Transforms）"></a>变换（Transforms）</h3><p>元素可以在二维或三维空间中动画化。 在这里，我将展示一些2D变换的例子。 要了解有关3D变换的更多信息，<a href="https://blog.logrocket.com/the-noobs-guide-to-3d-transforms-with-css-7370aafd9edf/" target="_blank" rel="noopener">请查看noob的3D变换指南</a>。</p>
<h4 id="旋转（Rotating）"><a href="#旋转（Rotating）" class="headerlink" title="旋转（Rotating）"></a>旋转（Rotating）</h4><iframe name="cp_embed_6" src="https://codepen.io/hopearmstrong/embed/ZZYgMe?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=hopearmstrong&amp;slug-hash=ZZYgMe&amp;pen-title=Rotating%20Spinner%20SVG%20Icon%20Animated%20with%20CSS%20%2F%20Sass&amp;name=cp_embed_6" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="Rotating Spinner SVG Icon Animated with CSS / Sass" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_ZZYgMe"></iframe>


<p>这是一个使用旋转变换的加载图标。想知道它是如何制作的吗？它从一个看起来像带有黑暗象限环的SVG开始的。</p>
<h4 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h4><iframe name="cp_embed_7" src="https://codepen.io/lukelogrocket/embed/rbZXra?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=lukelogrocket&amp;slug-hash=rbZXra&amp;pen-title=SVG%20-%205&amp;name=cp_embed_7" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG - 5" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_rbZXra"></iframe>

<p>在Sass中，以SVG标签的ID为目标。 然后给它定义动画和过渡。 动画引用<code>@keyframes</code>的名称，其中<code>transform：rotate</code>设置为从0度到360度（完整旋转一圈）。 这就是让这加载图标变得动起来所需要的一切！</p>
<h4 id="Sass"><a href="#Sass" class="headerlink" title="Sass"></a>Sass</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#loading</span><br><span class="line">  animation: loading-spinner 1s linear infinite</span><br><span class="line"></span><br><span class="line">@keyframes loading-spinner</span><br><span class="line">  from</span><br><span class="line">    transform: rotate(0deg)</span><br><span class="line">  to</span><br><span class="line">    transform: rotate(360deg)</span><br></pre></td></tr></table></figure>

<p>想要动画效果更平滑顺畅吗？ SVG支持渐变，因此你可以使用相同的Sass实现更平滑的效果，但需要使用具有渐变圆环的SVG（请参阅下面定义为<code>#spinner-gradient-a</code>）。</p>
<iframe name="cp_embed_8" src="https://codepen.io/hopearmstrong/embed/yrymwg?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=hopearmstrong&amp;slug-hash=yrymwg&amp;pen-title=Rotating%20Loading%20SVG%20Icon%20with%20Gradient%20Animated%20with%20CSS%20%2F%20Sass&amp;name=cp_embed_8" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="Rotating Loading SVG Icon with Gradient Animated with CSS / Sass" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_yrymwg"></iframe>

<p>现在，让我们使用<code>transform：scale</code>来创建一个变形条加载图标。</p>
<iframe name="cp_embed_9" src="https://codepen.io/hopearmstrong/embed/VNYoNq?height=265&amp;theme-id=0&amp;default-tab=css%2Cresult&amp;user=hopearmstrong&amp;slug-hash=VNYoNq&amp;pen-title=SVG%20Loading%20Bars%20Animated%20with%20CSS%20%2F%20Sass&amp;name=cp_embed_9" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="SVG Loading Bars Animated with CSS / Sass" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_VNYoNq"></iframe>

<p>SVG由三个大小相等的矩形组成，均匀分布。给SVG和三个<code>&lt;rect&gt;</code>元素都添加了ID，因此可以使用Sass轻松定位它们。</p>
<p>Sass将动画应用于每个矩形。 关键帧告诉矩形图在时间轴中的四个位置沿Y轴改变比例：开始时，四分之一，中途，然后是四分之三。动画中的第一个数字表示动画时间长度，而第二个表示设置延迟。 由于我希望这些矩形在不同时间变形，我为每个条形添加了不同的延迟。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#loading-bar</span><br><span class="line">  &amp;-left</span><br><span class="line">    animation: loading-bar-morph 1s linear .1s infinite</span><br><span class="line">    transform-origin: center</span><br><span class="line">  &amp;-middle</span><br><span class="line">    animation: loading-bar-morph 1s linear .2s infinite</span><br><span class="line">    transform-origin: center</span><br><span class="line">  &amp;-right</span><br><span class="line">    animation: loading-bar-morph 1s linear .4s infinite</span><br><span class="line">    transform-origin: center</span><br><span class="line"></span><br><span class="line">@keyframes loading-bar-morph </span><br><span class="line">  0%</span><br><span class="line">    transform: scaleY(1)</span><br><span class="line">  25%</span><br><span class="line">    transform: scaleY(0.3)</span><br><span class="line">  50%</span><br><span class="line">    transform: scaleY(0.7)</span><br><span class="line">  75%</span><br><span class="line">    transform: scaleY(0.15)</span><br></pre></td></tr></table></figure>

<h4 id="变换原点"><a href="#变换原点" class="headerlink" title="变换原点"></a>变换原点</h4><p>请注意，<code>transform-origin：center</code>表示从条形中心开始缩放; 否则，它会从顶部向下扩展，看起来就像是钻杆钻入地面。 测试一下，你会明白我的意思。 这是一个值得学习的重要课程：默认情况下，SVG原点位于左上角的（0,0）点。 如果你习惯使用HTML元素，这是一个关键的区别，HTML元素的默认变换原点始终为（50％，50％）。</p>
<h3 id="Fancier-techniques"><a href="#Fancier-techniques" class="headerlink" title="Fancier techniques"></a>Fancier techniques</h3><p><strong>线描动画</strong></p>
<iframe name="cp_embed_11" src="https://codepen.io/hopearmstrong/embed/BENBzj?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=hopearmstrong&amp;slug-hash=BENBzj&amp;pen-title=Line%20Drawing%20Animation%20(SVG%20and%20CSS%20%2F%20Sass)%20&amp;name=cp_embed_11" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="Line Drawing Animation (SVG and CSS / Sass) " class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_BENBzj"></iframe>


<p>这种漂亮的效果使你的SVG看起来就像被画出来一样。要得到上面的效果需要一个画线的SVG标签，因为它依赖于笔画。我将引导你了解如何用一条线完成它，然后你就知道如何完成剩下的工作。</p>
<p>首先，使用<code>stroke-dasharray</code>对行进行虚线描边。数值表示以px为单位的线的长度。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#line</span><br><span class="line">  stroke-dasharray: 497</span><br></pre></td></tr></table></figure>

<p>然后添加<code>stroke-dashoffset</code>指定dash模式到路径开始的距离。让它尽可能得长使它看起来像一条实线。这是动画的最终帧的外观。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#line</span><br><span class="line">  stroke-dasharray: 497</span><br><span class="line">  stroke-dashoffset: 497</span><br></pre></td></tr></table></figure>

<p>现在它已经准备好可以动起来了。 添加为<code>stroke-dashoffset</code>设置动画的关键帧，使其从完全偏移（无可用笔划）变为0px偏移（实心笔划）。 注意动画属性中的<code>forwards</code>。 这是<code>animation-fill-mode</code>的其中一种取值，它告诉动画一旦播放就会保持最终结束状态。 没有它，动画将播放然后返回其第一个“帧”作为其最终的结束点。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#line</span><br><span class="line">  stroke-dasharray: 497</span><br><span class="line">  stroke-dashoffset: 497</span><br><span class="line">  animation: draw 1400ms ease-in-out 4ms forwards</span><br><span class="line"></span><br><span class="line">@keyframes draw</span><br><span class="line">  from</span><br><span class="line">    stroke-dashoffset: 1000</span><br><span class="line">  to</span><br><span class="line">    stroke-dashoffset: 0</span><br></pre></td></tr></table></figure>

<h4 id="插图动画"><a href="#插图动画" class="headerlink" title="插图动画"></a>插图动画</h4><p>下面这个带着笑脸的心形，在鼠标悬停时会触发一些动画。 心形的大小变化为110％，而上面笑脸的眼睛变小，嘴巴变大并出现红晕，心形出现脉冲效果动画。 对于脉冲效果，我使用了<a href="http://animista.net/" target="_blank" rel="noopener">Animista</a>的Heartbeat动画。 Animista是开发CSS动画效果的绝佳资源，你可以重复使用和迭代。</p>
<iframe name="cp_embed_12" src="https://codepen.io/hopearmstrong/embed/eoNYQY?height=265&amp;theme-id=0&amp;default-tab=css%2Cresult&amp;user=hopearmstrong&amp;slug-hash=eoNYQY&amp;pen-title=Beating%20Heart%20SVG%20Animated%20on%20Hover%20with%20CSS%20%2F%20Sass&amp;name=cp_embed_12" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="Beating Heart SVG Animated on Hover with CSS / Sass" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_eoNYQY"></iframe>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#smiley-love</span><br><span class="line">  #smiley</span><br><span class="line">    &amp;-blush</span><br><span class="line">      display: none</span><br><span class="line">  a</span><br><span class="line">    display: inline-block</span><br><span class="line">    &amp;:hover</span><br><span class="line">      #smiley</span><br><span class="line">        transform: scale(1.1)</span><br><span class="line">        transform-origin: center</span><br><span class="line">        -webkit-animation: heartbeat 1.5s ease-in-out infinite both</span><br><span class="line">        animation: heartbeat 1.5s ease-in-out infinite both</span><br><span class="line">        &amp;-blush</span><br><span class="line">          display: inherit</span><br><span class="line">        &amp;-eye-left</span><br><span class="line">          transform-origin: center</span><br><span class="line">          transform: scale(.7) translate(-8px)</span><br><span class="line">        &amp;-eye-right</span><br><span class="line">          transform-origin: center</span><br><span class="line">          transform: scale(.7) translate(8px)</span><br><span class="line">        &amp;-mouth</span><br><span class="line">          transform: translateY(-22px) scale(1.6)</span><br><span class="line">          transform-origin: center</span><br><span class="line"></span><br><span class="line">/* ----------------------------------------------</span><br><span class="line"> * animation heartbeat</span><br><span class="line"> * Generated by Animista on 2019-3-24 18:51:13</span><br><span class="line"> * w: http://animista.net, t: @cssanimista</span><br><span class="line"> * ---------------------------------------------- */</span><br><span class="line"></span><br><span class="line">@-webkit-keyframes heartbeat</span><br><span class="line">  from</span><br><span class="line">    -webkit-transform: scale(1)</span><br><span class="line">            transform: scale(1)</span><br><span class="line">    -webkit-transform-origin: center center</span><br><span class="line">            transform-origin: center center</span><br><span class="line">    -webkit-animation-timing-function: ease-out</span><br><span class="line">            animation-timing-function: ease-out</span><br><span class="line">  10%</span><br><span class="line">    -webkit-transform: scale(0.91)</span><br><span class="line">            transform: scale(0.91)</span><br><span class="line">    -webkit-animation-timing-function: ease-in</span><br><span class="line">            animation-timing-function: ease-in</span><br><span class="line">  17%</span><br><span class="line">    -webkit-transform: scale(0.98)</span><br><span class="line">            transform: scale(0.98)</span><br><span class="line">    -webkit-animation-timing-function: ease-out</span><br><span class="line">            animation-timing-function: ease-out</span><br><span class="line">  33%</span><br><span class="line">    -webkit-transform: scale(0.87)</span><br><span class="line">            transform: scale(0.87)</span><br><span class="line">    -webkit-animation-timing-function: ease-in</span><br><span class="line">            animation-timing-function: ease-in</span><br><span class="line">  45%</span><br><span class="line">    -webkit-transform: scale(1)</span><br><span class="line">            transform: scale(1)</span><br><span class="line">    -webkit-animation-timing-function: ease-out</span><br><span class="line">            animation-timing-function: ease-out</span><br><span class="line">@keyframes heartbeat</span><br><span class="line">  from</span><br><span class="line">    -webkit-transform: scale(1)</span><br><span class="line">            transform: scale(1)</span><br><span class="line">    -webkit-transform-origin: center center</span><br><span class="line">            transform-origin: center center</span><br><span class="line">    -webkit-animation-timing-function: ease-out</span><br><span class="line">            animation-timing-function: ease-out</span><br><span class="line">  10%</span><br><span class="line">    -webkit-transform: scale(0.91)</span><br><span class="line">            transform: scale(0.91)</span><br><span class="line">    -webkit-animation-timing-function: ease-in</span><br><span class="line">            animation-timing-function: ease-in</span><br><span class="line">  17%</span><br><span class="line">    -webkit-transform: scale(0.98)</span><br><span class="line">            transform: scale(0.98)</span><br><span class="line">    -webkit-animation-timing-function: ease-out</span><br><span class="line">            animation-timing-function: ease-out</span><br><span class="line">  33%</span><br><span class="line">    -webkit-transform: scale(0.87)</span><br><span class="line">            transform: scale(0.87)</span><br><span class="line">    -webkit-animation-timing-function: ease-in</span><br><span class="line">            animation-timing-function: ease-in</span><br><span class="line">  45%</span><br><span class="line">    -webkit-transform: scale(1)</span><br><span class="line">            transform: scale(1)</span><br><span class="line">    -webkit-animation-timing-function: ease-out</span><br><span class="line">            animation-timing-function: ease-out</span><br></pre></td></tr></table></figure>

<p>对于下面这个冰棒图，我通过使用<code>transform：translate</code>来改变它们的位置。 为了让它们消失，我设置了透明度变化。 现在它看起来像是炎热夏日里的冰棒在融化！</p>
<iframe name="cp_embed_13" src="https://codepen.io/hopearmstrong/embed/qwdBwR?height=265&amp;theme-id=0&amp;default-tab=html%2Cresult&amp;user=hopearmstrong&amp;slug-hash=qwdBwR&amp;pen-title=Melting%20Popsicle%20SVG%20Animated%20with%20CSS%20%2F%20Sass&amp;name=cp_embed_13" scrolling="no" frameborder="0" height="265" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="Melting Popsicle SVG Animated with CSS / Sass" class="cp_embed_iframe" style="width: 100%; overflow:hidden; display:block" id="cp_embed_qwdBwR"></iframe>

<h4 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h4><p>你可以使用前面提到的CSS / Sass自己动手，或者使用像<a href="https://daneden.github.io/animate.css/" target="_blank" rel="noopener">Animate.CSS</a>这样的插件来快速开发。 它包含常用动画的现成的样式类，例如淡入淡出，幻灯片，摇动等等。 如果您想探索JavaScript的方式，我听说过Greensock的<a href="https://greensock.com/gsap" target="_blank" rel="noopener">GSAP</a>是很棒的东西，它有一个强大的插件叫做MorphSVGPlugin，可以让你将SVG形状变形为另一种形状。</p>
<h3 id="跨浏览器兼容性"><a href="#跨浏览器兼容性" class="headerlink" title="跨浏览器兼容性"></a>跨浏览器兼容性</h3><p>许多CSS动画在不同的浏览器都得到了很好的支持，但仍有一些事情需要注意。 比如：</p>
<h4 id="浏览器前缀"><a href="#浏览器前缀" class="headerlink" title="浏览器前缀"></a>浏览器前缀</h4><p>您可以在<a href="http://shouldiprefix.com/" target="_blank" rel="noopener">shouldiprefix.com</a>检查确认是否需要加上针对特定浏览器的前缀。在撰写本文时，建议你都加上<code>-webkit-animation</code>和<code>@ -webkit-keyframes</code>前缀。</p>
<h4 id="浏览器测试"><a href="#浏览器测试" class="headerlink" title="浏览器测试"></a>浏览器测试</h4><p>请记住，尽管有大部分浏览器支持，但你可能会遇到一些渲染差异。 例如，如果你想支持旧版本的Firefox（v.42及更低版本），请留意有关<code>transform-origin</code>的兼容问题。 虽然Firefox最新版现在已经修复，但有一段时间不接受任何关键字（例如<code>center</code>）或变换原点的百分比。 因此，如果你遇到渲染问题，请尝试使用px。 你可以查看 <code>cx</code> 和 <code>cy</code> 属性来计算原点中心。 要在多个浏览器和设备上查找渲染差异，可以在<a href="https://www.browserstack.com/" target="_blank" rel="noopener">BrowserStack</a>上测试你的动画以查找任何奇怪的问题。Chrome DevTools有一个动画选项卡，有助于深入了解动画状态。 它允许你通过时间轴可视化来查看页面上动画执行情况，也可以慢动作重放动画，以及修改动画。</p>
<p><img src="https://storage.googleapis.com/blog-images-backup/0*YQLulhc9UsTKXK0L" alt="Chrome DevTools"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>现在你已经了解了使用CSS为SVG制作动画的几种不同方法，希望你能够为自己的网页创建动画！而只需几行CSS代码就能将静态SVG变得动起来，这是很有趣的。 一旦掌握了一些技巧，就可以更轻松地处理更复杂的动画。 一些在线编辑器比如<a href="https://codepen.io/" target="_blank" rel="noopener">CodePen</a>等有很大有趣的动画，可以给你带来无穷无尽的灵感！</p>]]></content>
      <categories>
        <category>translate</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>svg</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue开发遇到的问题积累</title>
    <url>/2018/02/15/vue-bugs/</url>
    <content><![CDATA[<p>以下问题出现的场景都是基于vue2.x，如果是vue 1.x，可能就没有参考意义了。</p>
<a id="more"></a>


<h2 id="绑定事件如何主动传当前元素"><a href="#绑定事件如何主动传当前元素" class="headerlink" title="绑定事件如何主动传当前元素"></a>绑定事件如何主动传当前元素</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@click=&quot;onClick($event, others)&quot;</span><br></pre></td></tr></table></figure>

<h2 id="vue-config如何配置不同打包后的文件输出路径"><a href="#vue-config如何配置不同打包后的文件输出路径" class="headerlink" title="vue.config如何配置不同打包后的文件输出路径"></a>vue.config如何配置不同打包后的文件输出路径</h2><p>在使用vue的cli 3.x后，webpack的打包配置都通过项目根目录的<code>vue.config.js</code>进行配置，而默认这个文件是不存在的，需要自己创建和书写配置。</p>
<p>假如现在有个需求，我想在不同的打包命令下，打包后的文件输出在不同的本地文件夹：<br>在<code>package.json</code>文件配置了两个命令<br>（1）当我执行<code>npm run build</code>时，进行文件打包，打包后的文件输出在当前项目目录的<code>dist</code>文件夹（vue cli默认的配置就是如此）<br>（2）当我执行<code>npm run publish</code>时，进行文件打包，打包后的文件输出在某个指定的本地目录的某个文件夹</p>
<p>方法：</p>
<blockquote>
<p>通过修改打包命令进行传参数，让<code>vue.config.js</code>文件获取到参数来区分不同的打包操作，从而修改打包后的输出文件路径</p>
</blockquote>
<p><code>package.json</code>文件配置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;vue-cli-service build&quot;,</span><br><span class="line">    &quot;publish&quot;: &quot;npm_config_publish=true npm run build&apos;&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p><code>vue.config.js</code>文件配置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    baseUrl: &apos;&apos;,</span><br><span class="line">    // 打包输出文件目录</span><br><span class="line">    outputDir: process.env.npm_config_publish ? &apos;/Users/xxx/Documents/host/test/projectname&apos; : &apos;dist&apos; ,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上的打包配置，在<code>npm run publish</code>时，打包后的文件就会存在你本地的<code>&#39;/Users/xxx/Documents/host/test/projectname</code>里。</p>
<h2 id="Element-ui的table事件如何传自定义参数"><a href="#Element-ui的table事件如何传自定义参数" class="headerlink" title="Element-ui的table事件如何传自定义参数"></a>Element-ui的table事件如何传自定义参数</h2><p>例子代码片段（<code>row-click</code>为表格当某一行被点击时会触发该事件）：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;el-table</span><br><span class="line">    ref=&quot;fieldsTable&quot;</span><br><span class="line">    @row-click=&quot;onRowClick&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br></pre></td></tr></table></figure>

<p>而该事件默认有三个参数：<code>row, column, event</code>，参数的意义可以看<a href="http://element-cn.eleme.io/#/zh-CN/component/table" target="_blank" rel="noopener">element-ui官方文档</a></p>
<p>问题：如果我的table是个数组循环渲染，需要传个当前table下标<code>index</code><br>第一反应的方案是：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template v-for=&quot;(item, index) in data&quot;&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">        ref=&quot;fieldsTable&quot;</span><br><span class="line">        @row-click=&quot;onRowClick(row, column, event, index)&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>这种写法虽然能够获取到<code>index</code>的值，但是，<code>row</code> <code>column</code> <code>event</code>这三个变量的值就变成<code>undefined</code></p>
<blockquote>
<p>因为如果在绑定的时，给<code>onRowClick</code>传入的三个参数，是当前上下文的三个新变量，而当前上下文并没有声明有这三个变量，所以是<code>undefined</code>，而传入的<code>undefined</code>就覆盖了<code>row-click</code>事件的三个默认参数。</p>
</blockquote>
<p>我们可以改造一下写法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template v-for=&quot;(item, index) in data&quot;&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">        ref=&quot;fieldsTable&quot;</span><br><span class="line">        @row-click=&quot;(row, column, event)=&gt;&#123;return onRowClick(row, column, event, index)&#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>这样，在<code>onRowClick</code>就可以正常获取到四个参数的值。</p>]]></content>
      <categories>
        <category>bugs</category>
      </categories>
      <tags>
        <tag>bug</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Webp图片降级方案有哪些</title>
    <url>/2018/01/02/webp-image-degradation-plan/</url>
    <content><![CDATA[<p>Webp已经开始慢慢流行，有些产品还要考虑到一些低版本浏览器的情况，所以做兼容还是少不了，本文来探讨一下，Webp图片降级方案有哪些。</p>
<a id="more"></a>

<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>无论哪种方案，前提你都需要有两套格式的图片。可以通过各种工具进行批量转换。</p>
<h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><p><code>前端处理</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">picture</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">srcset</span>=<span class="string">"img/awesomeWebPImage.webp"</span> <span class="attr">type</span>=<span class="string">"image/webp"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">srcset</span>=<span class="string">"img/creakyOldJPEG.jpg"</span> <span class="attr">type</span>=<span class="string">"image/jpeg"</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/creakyOldJPEG.jpg"</span> <span class="attr">alt</span>=<span class="string">"Alt Text!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">picture</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对于每个浏览器都可以用，而不只是支持<code>&lt;picuture&gt;</code>元素的浏览器。这是因为不支持<code>&lt;picture&gt;</code>的浏览器只会显示<code>img</code>指定的图片。</p>
<h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><p><code>前端处理</code></p>
<blockquote>
<p>这种方案的原理就是通过先检测当前浏览器是否支持<code>webp</code>格式来决定图片和图片背景采用哪种图片格式来展示。</p>
</blockquote>
<ul>
<li>第一步，需要知道浏览器是否支持<code>webp</code>格式</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>).toDataURL(<span class="string">'image/webp'</span>);</span><br></pre></td></tr></table></figure>

<p>如果浏览器支持<code>webp</code>格式，返回的结果带有<code>data:image/webp;</code>：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">data:image/webp;base64,UklGRrgAAABXRUJQVlA4WAoAAAAQAAAAKwEAlQAAQUxQSBIAAAABBxARERCQJP7/H0X0P+1/QwBWUDgggAAAAHANAJ0BKiwBlgA+bTaZSaQjIqEgKACADYlpbuF2sRtACewD32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99qwAAP7/1gAAAAAAAAAA</span><br></pre></td></tr></table></figure>

<p>如果浏览器不支持<code>webp</code>格式，返回的结果不带有<code>data:image/webp;</code>：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAACWCAYAAABkW7XSAAAAAXNSR0IArs4c6QAAAylJREFUeAHt0DEBAAAAwqD1T20IX4hAYcCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYOAdGL/UAAEPpnR6AAAAAElFTkSuQmCC</span><br></pre></td></tr></table></figure>

<p>或者可以一开始，通过触发一张只有1像素的<code>webp</code>图片，监听它的<code>onload</code>事件，如果成功，说明浏览器支持<code>webp</code>格式，如果不支持，说明浏览器不支持啦。<br>不过这种首先你得准备这张图片，其次，你要每次都去请求这张图片。</p>
<ul>
<li>第二步，根据不同浏览器支持情况展示不同格式</li>
</ul>
<p>在第一步，外面通过js知道浏览器支持情况，然后把两种格式的图片都放到img标签的自定义属性，根据不同情况取不同的图片地址显示出来即可。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">"https://xxx.w3cmark.com/f7b07c8.jpg"</span> <span class="attr">data-webp</span>=<span class="string">"https://xxx.w3cmark.com/f7b07c8.webp"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>至于样式，可以直接根据检测的结果在<code>body</code>标签加入一个特殊样式，然后把<code>webp</code>的背景图写在这个样式下即可。</p>
<h3 id="方案三"><a href="#方案三" class="headerlink" title="方案三"></a>方案三</h3><p><code>服务端处理</code></p>
<p>前端统一请求图片地址，比如<code>https://xxx.w3cmark.com/f7b07c8.jpg</code>，服务端接受到客户端请求时，根据<code>request</code>头的<code>accept</code>字段来判断，返回哪种格式的图片。</p>
<p>客户端支持<code>webp</code>格式时，<code>request</code>头的<code>accept</code>字段会有<code>image/webp</code>，如下图：</p>
<p><img src="https://user-images.githubusercontent.com/7434649/48115040-5f830e00-e29c-11e8-848f-ca71b6aef367.png" alt="image"></p>
<p>不支持时：</p>
<p><img src="https://user-images.githubusercontent.com/7434649/48115142-d15b5780-e29c-11e8-8390-927575f1d10a.png" alt="image"></p>
<p>官方对<code>accept</code>字段的解释：</p>
<blockquote>
<p>The Accept request-header field can be used to specify certain media types which are acceptable for the response. Accept headers can be used to indicate that the request is specifically limited to a small set of desired types, as in the case of a request for an in-line image.<br>google翻译一下：</p>
</blockquote>
<blockquote>
<p>Accept request-header字段可用于指定响应可接受的某些媒体类型。 接受标头可用于指示请求特别限于一小组所需类型，如在请求内嵌图像的情况下。</p>
</blockquote>
<p>这种方案前端不用做特殊处理，但是服务端返回处理写死后，就不太灵活了，如果有某些场景就是想要访问非webp呢？<br>需要具体方案看业务的具体场景来用哈。</p>]]></content>
      <categories>
        <category>其它</category>
      </categories>
      <tags>
        <tag>webp</tag>
      </tags>
  </entry>
</search>
